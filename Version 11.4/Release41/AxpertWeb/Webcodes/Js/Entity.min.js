/*https://web.agile-labs.com/minZIP/*//*version=3.9.1*/function _slicedToArray(e,t){return _arrayWithHoles(e)||_iterableToArrayLimit(e,t)||_unsupportedIterableToArray(e,t)||_nonIterableRest()}function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function _iterableToArrayLimit(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var a,i,o=[],s=!0,r=!1;try{for(n=n.call(e);!(s=(a=n.next()).done)&&(o.push(a.value),!t||o.length!==t);s=!0);}catch(l){r=!0,i=l}finally{try{s||null==n["return"]||n["return"]()}finally{if(r)throw i}}return o}}function _arrayWithHoles(e){if(Array.isArray(e))return e}function _createForOfIteratorHelper(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=_unsupportedIterableToArray(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var a=0,i=function(){};return{s:i,n:function(){return a>=e.length?{done:!0}:{done:!1,value:e[a++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,s=!0,r=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return s=e.done,e},e:function(e){r=!0,o=e},f:function(){try{s||null==n["return"]||n["return"]()}finally{if(r)throw o}}}}function ownKeys(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,a)}return n}function _objectSpread(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?ownKeys(Object(n),!0).forEach(function(t){_defineProperty(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):ownKeys(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}function _defineProperty(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function _typeof(e){"@babel/helpers - typeof";return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function _toConsumableArray(e){return _arrayWithoutHoles(e)||_iterableToArray(e)||_unsupportedIterableToArray(e)||_nonIterableSpread()}function _nonIterableSpread(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function _unsupportedIterableToArray(e,t){if(e){if("string"==typeof e)return _arrayLikeToArray(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?_arrayLikeToArray(e,t):void 0}}function _iterableToArray(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}function _arrayWithoutHoles(e){if(Array.isArray(e))return _arrayLikeToArray(e)}function _arrayLikeToArray(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,a=new Array(t);n<t;n++)a[n]=e[n];return a}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}function _createClass(e,t,n){return t&&_defineProperties(e.prototype,t),n&&_defineProperties(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}var isFetching=!1,dtCulture=eval(callParent("glCulture")),_entity,_entityCommon,currentEditFieldId=null,rowData,pageNo=1,rowsCountHelper,Entity=function(){function e(){_classCallCheck(this,e),this.entityName="",this.entityTransId="",this.metaData={},this.listJson={},this.maxPageNumber=1,this.pageSize=100,this.kpiJson=[],this.chartsJson=[],this.chartsMetaData={},this.selectedChartsArr=[],this.selectedChartCaptions={},this.emptyRowsHtml='<div class="d-flex flex-column text-center h-100 justify-content-center">\n                                    <span class="material-icons material-icons-style material-icons-5tx mx-auto text-gray-500" style="color: red !important;">report</span>\n                                    <h3 class="fw-boldest">No Data Found</h3>\n                                </div>',this.nullRowsHtml="Configure the fields properly in the 'Select Field(s)' option",this.fields="All",this.keyField="",this.filter=[],this.filterObj={},this.allowCreate=!0,this.isLastPage=!1,this.tableViewFlag=!0,this.viewChart=!0,this.captionsEnabled=!1,this.lastScrollTop=0,this.lastScrollLeft=0,this.properties={},this.modificationFields="",this.rightPanel="collapsed",this.customHyperLinks=[],this.navigationRecords=[],this.allRecordsLoaded=!1}return _createClass(e,[{key:"init",value:function(){ShowHideDimmer(!1);try{var e,t,n,a,i,o=window.location.search,s=new URLSearchParams(o);this.entityTransId=s.get("tstid");var r=hdnPageVars.value;"undefined"!=typeof(r=JSON.parse(r)).PageSize&&(this.pageSize=r.PageSize);var l,c,d,u=document.querySelector("#hdnEntityPageLoadData").value;if(u=u.replaceAll("T00:00:00","").replaceAll(" 00:00:00",""),0==(null===(e=u=JSON.parse(u))||void 0===e?void 0:null===(t=e.result)||void 0===t?void 0:t.success))return void showAlertDialog("error",(null!==(l=null===(c=u)||void 0===c?void 0:null===(d=c.result)||void 0===d?void 0:d.message)&&void 0!==l?l:"Error occurred.")+" Please check with administrator.");this.properties=u.result.data.Properties,this.tableViewFlag=!this.properties.TABLEVIEW||"false"!==this.properties.TABLEVIEW.toLowerCase(),this.captionsEnabled=this.properties.CAPTIONVALUE&&"true"===this.properties.CAPTIONVALUE.toLowerCase()||!1,this.entityTransId=u.result.data.TransId,u.result.data.EntityName&&(this.entityName=u.result.data.EntityName,document.title=this.entityName),this.applyTheme(),highlightInitialSelection(),document.querySelector("#EntityTitle").innerHTML=this.entityName||u.result.data.EntityName,this.metaData=u.result.data.MetaData;var m=this.metaData.find(function(e){return"dc1"===e.dcname});m&&m.tablename;if(this.listJson=null!==(n=u.result.data.ListData)&&void 0!==n&&null!==(a=n[0])&&void 0!==a&&a.data_json?JSON.parse(u.result.data.ListData[0].data_json):[],this.fields=this.properties.FIELDS||"All",this.keyField=this.properties.KEYFIELD||"",(0==this.pageSize||this.pageSize>this.listJson.length)&&(this.allRecordsLoaded=!0),_entityCommon.isValid(this.properties.CONFIG)){var p=JSON.parse(this.properties.CONFIG);this.customHyperLinks=p.HYPERLINKS||[]}if(this.properties.CHARTS&&(this.selectedChartsArr=JSON.parse(this.properties.CHARTS)),this.maxPageNumber=u.result.data.PageNo,_entityCommon.isValid(this.properties.FILTERS)&&(_entityFilter.filterObj=JSON.parse(this.properties.FILTERS),_entityFilter.createFilterPills()),"All"==this.fields)this.modificationFields="modifiedon,modifiedby,createdon,createdby";else{var h=["modifiedby","modifiedon","createdby","createdon"],f=[];this.fields.split(",").forEach(function(e){h.indexOf(e)>-1&&f.push(e)}),this.modificationFields=f.join(",")||""}try{AxBeforeDataListLoad(this)}catch(y){}(null===(i=this.listJson)||void 0===i?void 0:i.length)>0?(this.populateInitialView(),this.rightPanelView()):(document.querySelector("#body_Container").innerHTML=this.emptyRowsHtml,document.querySelector("#table-body_Container").innerHTML=this.emptyRowsHtml),this.bindEvents(),(rowsCountHelper=new RowsCountHelper).init(),this.addCustomParams(),this.customHyperLinks.length>0&&this.constructCustomHyperLinkAccordions(),ShowHideDimmer(!1);try{AxAfterDataListLoad(this)}catch(v){}}catch(g){ShowHideDimmer(!1),showAlertDialog("error",appGlobalVarsObject.lcm[572]),console.error(g)}}},{key:"rightPanelView",value:function(){toggleRightPanel("expanded"===(this.properties.RIGHTPANEL||"collapsed")?"expand":"collapse",!1)}},{key:"addCustomParams",value:function(){var e=this.metaData.find(function(e){return"dc1"===e.dcname}),t=e?e.tablename:null;this.metaData.push({ftransid:this.entityTransId,fcaption:this.entityName,fldname:"createdon",fldcap:"Created on",cdatatype:"Date",fdatatype:"d",fmodeofentry:"calculate",hide:"F",props:null,normalized:"F",allowempty:"T",filtertype:"Text",tablename:t,dcname:"dc1"}),this.metaData.push({ftransid:this.entityTransId,fcaption:this.entityName,fldname:"createdby",fldcap:"Created by",cdatatype:"DropDown",fdatatype:"c",fmodeofentry:"calculate",hide:"F",props:null,normalized:"F",allowempty:"T",filtertype:"Text",tablename:t,dcname:"dc1"}),this.metaData.push({ftransid:this.entityTransId,fcaption:this.entityName,fldname:"modifiedon",fldcap:"Modified on",cdatatype:"Date",fdatatype:"d",fmodeofentry:"calculate",hide:"F",props:null,normalized:"F",allowempty:"T",filtertype:"Text",tablename:t,dcname:"dc1"}),this.metaData.push({ftransid:this.entityTransId,fcaption:this.entityName,fldname:"username",fldcap:"Modified by",cdatatype:"DropDown",fdatatype:"c",fmodeofentry:"calculate",hide:"F",props:null,normalized:"F",allowempty:"T",filtertype:"Text",tablename:t,dcname:"dc1"})}},{key:"generateHTMLBasedOnDataType",value:function(e,t){var n=e.fldname,a=getFieldDataType(e),i=e.fldcap?e.fldcap.replaceAll("*",""):"",o=e.props,s=t[n.toLowerCase()];if("modifiedon"===n.toLowerCase()||"username"===n.toLowerCase()||"createdby"===n.toLowerCase()||"createdon"===n.toLowerCase())return"";if(_entity.inValid(s)&&"BUTTON"!=a.toUpperCase())return"";var r="",l=this.captionsEnabled?"":'data-toggle="tooltip" data-placement="top" title="'.concat(i,'"');switch(this.captionsEnabled&&(r='<div class="Data-fields-items" '.concat(l,'>\n                        <div class="caption-style">\n                            <span class="txt-bold Data-field-caption">').concat(i,'</span>\n                            <span class="txt-bold Data-field-value">').concat(s,"</span>\n                        </div>\n                    </div>")),a.toUpperCase()){case"LARGE TEXT":r=r||'<div class="Data-fields-items Department-field" '.concat(l,' data-name="').concat(i.toLowerCase().replaceAll("*","").replaceAll(" ",""),'">\n                            <p class="task-description moretext" style="margin-bottom:0px !important;">').concat(s,'</p>\n                            <a class="moreless-button" href="#">Read more</a>\n                        </div>');break;case"SHORT TEXT":r=r||'<div class="Data-fields-items Department-field" '.concat(l,' data-name="').concat(i.toLowerCase().replaceAll("*","").replaceAll(" ",""),'">\n                            <span class="material-icons material-icons-style material-icons-2">description</span><span class="txt-bold Data-field-value">').concat(s,"</span>\n                        </div>");break;case"CURRENCY":r=r||'<div class="Data-fields-items Department-field" '.concat(l,' data-name="').concat(i.toLowerCase().replaceAll("*","").replaceAll(" ",""),'">\n                            <span class="material-icons material-icons-style material-icons-2">payments</span><span class="txt-bold Data-field-value">').concat(s,"</span>\n                        </div>");break;case"DATE":var c=formatDateString(s);r=this.captionsEnabled?'<div class="Data-fields-items Date-field" '.concat(l,'>\n                                    <div class="caption-style">\n                                        <span class="txt-bold Data-field-caption">').concat(i,'</span>\n                                        <span class="txt-bold Data-field-value">').concat(c,"</span> \x3c!-- Use formatted date here --\x3e\n                                    </div>\n                                </div>"):'<div class="Data-fields-items Date-field" '.concat(l,' data-name="').concat(i.toLowerCase().replaceAll("*","").replaceAll(" ",""),'">\n                                    <span class="material-icons material-icons-style material-icons-2">today</span>\n                                    <span class="txt-bold Data-field-value">').concat(c,"</span>\n                                </div>");break;case"TIME":r=r||'<div class="Data-fields-items Time-field" '.concat(l,' data-name="').concat(i.toLowerCase().replaceAll("*","").replaceAll(" ",""),'">\n                            <span class="material-icons material-icons-style material-icons-2">schedule</span><span class="txt-bold Data-field-value">').concat(s,"</span>\n                        </div>");break;case"LINK":r=r||'<div class="Data-fields-items link-field" '.concat(l,' data-name="').concat(i.toLowerCase().replaceAll("*","").replaceAll(" ",""),'">\n                            <span class="material-icons material-icons-style material-icons-2">link</span><span class="txt-bold Data-field-value">').concat(s,"</span>\n                        </div>");break;case"MOBILE":case"PHONE":r=r||'<div class="Data-fields-items Email-field" '.concat(l,' data-name="').concat(i.toLowerCase().replaceAll("*","").replaceAll(" ",""),'">\n                            <span class="material-icons material-icons-style material-icons-2">phone</span><span class="txt-bold Data-field-value">').concat(s,"</span>\n                        </div>");break;case"PINCODE":case"ZIPCODE":r=r||'<div class="Data-fields-items Email-field" '.concat(l,' data-name="').concat(i.toLowerCase().replaceAll("*","").replaceAll(" ",""),'">\n                            <span class="material-icons material-icons-style material-icons-2">location_on</span><span class="txt-bold Data-field-value">').concat(s,"</span>\n                        </div>");break;case"EMAIL":r=r||'<div class="Data-fields-items Email-field truncate" '.concat(l,' data-name="').concat(i.toLowerCase().replaceAll("*","").replaceAll(" ",""),'">\n                            <span class="material-icons material-icons-style material-icons-2">mail</span><span class="txt-bold Data-field-value" data-text="').concat(s,'" onclick="showPopup(this)">').concat(s,"</span>\n                        </div>");break;case"BOOL":r="T"===s||"F"===s?r||'<div class="Data-fields-items Email-field" '.concat(l,' data-name="').concat(i.toLowerCase().replaceAll("*","").replaceAll(" ",""),'">\n                                <div class="form-check form-switch">\n                                    <input class="form-check-input" type="checkbox" role="switch" ').concat("T"===s?"checked":"",' readonly>\n                                    <span class="txt-bold Data-field-value">').concat(i,"</span>\n                                </div>\n                            </div>"):r||'<div class="Data-fields-items Department-field" '.concat(l,' data-name="').concat(i.toLowerCase().replaceAll("*","").replaceAll(" ",""),'">\n                                <span class="txt-bold Data-field-value">').concat(s,"</span>\n                            </div>");break;case"BUTTON":var d=o.split("|")[0].split("~")[1];r=r||'<a href="javascript:void(0)" title="View form"\n                           class="btn btn-white btn-color-gray-700 btn-active-primary d-inline-flex align-items-center btn-sm me-2 ">\n                            <span class="material-icons material-icons-style material-icons-2" style="color: darkmagenta;">'.concat(d,"</span>").concat(i,"\n                        </a>");break;case"ATTACHMENTS":if((null==s?void 0:s.length)>0){var u,m=parseFilePath(s);if((null===(u=m.filename)||void 0===u?void 0:u.length)>0){var p=getIconClass(getFileType(s));r=r||'<div class="Files-Attached" '.concat(l,">\n                                    ").concat(p,'\n                                    <div class="ms-1 fw-semibold">\n                                        <a class="attached-filename" onclick="downloadFileFromPath(\'').concat(m.folder.replaceAll("\\","\\\\"),"','").concat(m.filename,".").concat(m.ext,"')\">").concat(m.filename,"</a>\n                                    </div>\n                                </div>")}}break;default:r="T"===s||"F"===s?r||'<div class="Data-fields-items Department-field" '.concat(l,' data-name="').concat(i.toLowerCase().replaceAll("*","").replaceAll(" ",""),'">\n                                <div class="d-flex align-items-center">\n                                    <div class="form-check ms-1">\n                                        <input class="form-check-input" type="checkbox" ').concat("T"===s?"checked":""," readonly disabled>\n                                    </div>\n                                </div>\n                            </div>"):r||'<div class="Data-fields-items Department-field" '.concat(l,' data-name="').concat(i.toLowerCase().replaceAll("*","").replaceAll(" ",""),'">\n                                <span class="txt-bold Data-field-value">').concat(s,"</span>\n                            </div>")}return r}},{key:"populateInitialView",value:function(){var e=document.getElementById("body_Container");e.removeEventListener("scroll",scrollListener),this.tableViewFlag?(toggleView(!1,"table"),$("#themeMenuItem").addClass("d-none")):(createListHTML(this.listJson,pageNo),$("#themeMenuItem").removeClass("d-none"),e.addEventListener("scroll",scrollListener)),$('[data-toggle="tooltip"]').tooltip(),initReadMore()}},{key:"toggleCaptions",value:function(){var e=this;this.captionsEnabled=!this.captionsEnabled;var t={page:"Entity",transId:_entity.entityTransId,properties:{CAPTIONVALUE:this.captionsEnabled},confirmNeeded:!0,allUsers:!1};_entityCommon.setAnalyticsDataWS(t,function(){e.captionsEnabled=!e.captionsEnabled,_entity.saveCaptionValue(),_entity.refreshData()},function(e){showAlertDialog("error",e.status+" "+e.statusText)})}},{key:"saveCaptionValue",value:function(){var e={page:"Entity",transId:_entity.entityTransId,properties:{CAPTIONVALUE:this.captionsEnabled},allUsers:!1};_entityCommon.setAnalyticsDataWS(e,function(){_this.refreshData()},function(e){console.error("Error in SetEntityFieldsWS:",e),ShowHideDimmer(!1)})}},{key:"refreshData",value:function(){_entity.reloadEntityPage()}},{key:"generateCustomKPIHTML",value:function(e,t){var n="";return e.forEach(function(e){var a,i=(e.criteria||"").split("~"),o=i[1].trim(),s=i[2].trim();n+='\n           <div class="col-xl-12 col-lg-12 col-sm-12 Invoice-content-wrap">\n    <a href="#" class="Invoice-item" >\n        <div class="Invoice-icon">\n            <span class="material-icons material-icons-style material-icons-2">bar_chart</span>\n        </div>\n        <div class="Invoice-content" >\n            <h6 class="subtitle" data-keyname="'.concat(e.keyname||t,'" onclick="navigateToListPage(\'').concat(o,"', '").concat(s,"', this)\">").concat(e.keyname||t,'</h6>\n            <h3 class="title">').concat((null===(a=e.keyvalue)||void 0===a?void 0:a.toLocaleString())||0,'</h3>\n        </div>\n        <div class="Invoice-icon2"></div>\n    </a>\n</div>\n\n        ')}),n}},{key:"getEntityListData",value:function(e){ShowHideDimmer(!0);var t=this,n={transId:t.entityTransId,fields:t.fields,pageNo:e,pageSize:t.pageSize,filter:t.filter};1==e&&(t.isLastPage=!1),t.isLastPage?ShowHideDimmer(!1):this.callAPI("../aspx/Entity.aspx/GetEntityListDataWS",n,!0,function(n){if(n.success)try{var a,i,o,s,r=JSON.parse(JSON.parse(n.response).d);if((r=null!==(a=null===(i=r.result.data.ListData)||void 0===i?void 0:null===(o=i[0])||void 0===o?void 0:o.data_json)&&void 0!==a?a:"[]").constructor!=Array&&(r=JSON.parse(r)),0===r.length)return 1===e?(t.listJson=[],document.querySelector("#body_Container").innerHTML=t.emptyRowsHtml,document.querySelector("#table-body_Container").innerHTML=t.emptyRowsHtml,"0"==t.pageSize.toString()&&(t.allRecordsLoaded=!0)):(t.isLastPage=!0,noMoreRecordsMessage.style.display="block",setTimeout(function(){noMoreRecordsMessage.style.display="none"},3e3),t.allRecordsLoaded=!0),rowsCountHelper.init(),void ShowHideDimmer(!1);1===e&&(t.listJson=[],document.querySelector("#body_Container").innerHTML="",document.querySelector("#table-body_Container").innerHTML=""),(s=t.listJson).push.apply(s,_toConsumableArray(r)),t.maxPageNumber=e,("table"===_entity.viewMode?createTableViewHTML:createListHTML)(t.listJson,e),$('[data-toggle="tooltip"]').tooltip(),initReadMore(),"0"==t.pageSize.toString()&&(t.allRecordsLoaded=!0),rowsCountHelper.init(),ShowHideDimmer(!1)}catch(l){return showAlertDialog("error","Error occurred in data fetch."),void ShowHideDimmer(!1)}else ShowHideDimmer(!1)})}},{key:"hideChartsMenu",value:function(){var e;null===(e=document.querySelector("#add_chart"))||void 0===e||e.click()}},{key:"openEntityForm",value:function(e,t,n,a,i){var o="../aspx/EntityForm.aspx?tstid=".concat(t,"&recid=").concat(n);_entityCommon.loadHyperLink(o,"true")}},{key:"updateRelatedData",value:function(e,t){window.top.entityNavList||(window.top.entityNavList={}),window.top.entityNavList[e]=this.getNearestRecords(t),window.top.entityNavList.lastTransId=e,window.top.entityNavList.lastCaption="Other ".concat(this.entityName)}},{key:"getSelectedChartsCriteria",value:function(){var e=this,t=[];return e.selectedCharts.split("^").forEach(function(n){var a=n.split("~"),i=a[1],o=a[2];if(""!=i){var s=e.chartsMetaData.GroupFld[i];t.push("".concat(n,"~").concat(s.normalized,"~").concat(s.srctable||"","~").concat(s.srcfield||"","~").concat(s.allowempty,"~").concat(s.tablename,"~~"))}else{var r=e.chartsMetaData.AggFld[o];t.push("".concat(n,"~").concat(r.normalized,"~").concat(r.srctable||"","~").concat(r.srcfield||"","~").concat(r.allowempty,"~").concat(r.tablename,"~~"))}}),t.join("^")}},{key:"getChartCriteria",value:function(e){return e.split("~").slice(0,4).join("~")}},{key:"generateGeneralKPIHTML",value:function(e){var t="";return t+='\n            <div class="col-xl-12 col-lg-12 col-sm-12 Invoice-content-wrap">\n                <a href="#" class="Invoice-item">\n                    <div class="Invoice-icon">\n                        <span class="material-icons material-icons-style material-icons-2">bar_chart</span><i class="fas fa-signal"></i>\n                    </div>\n                    <div class="Invoice-content">\n                        <h6 class="subtitle">Total</h6>\n                        <h3 class="title">'.concat(e.totrec,'</h3>\n                    </div>\n                    <div class="Invoice-icon2"></div>\n                </a>\n            </div>\n        '),0!==e.cyear&&(t+='\n                <div class="col-xl-12 col-lg-12 col-sm-12 Invoice-content-wrap">\n                    <a href="#" class="Invoice-item">\n                        <div class="Invoice-icon">\n                            <span class="material-icons material-icons-style material-icons-2">bar_chart</span>\n                        </div>\n                        <div class="Invoice-content">\n                            <h6 class="subtitle">This year</h6>\n                            <h3 class="title">'.concat(e.cyear,'</h3>\n                        </div>\n                        <div class="Invoice-icon2"></div>\n                    </a>\n                </div>\n            ')),0!==e.cmonth&&(t+='\n                <div class="col-xl-12 col-lg-12 col-sm-12 Invoice-content-wrap">\n                    <a href="#" class="Invoice-item">\n                        <div class="Invoice-icon">\n                            <span class="material-icons material-icons-style material-icons-2">bar_chart</span>\n                        </div>\n                        <div class="Invoice-content">\n                            <h6 class="subtitle">This month</h6>\n                            <h3 class="title">'.concat(e.cmonth,'</h3>\n                        </div>\n                        <div class="Invoice-icon2"></div>\n                    </a>\n                </div>\n            ')),0!==e.cweek&&(t+='\n                <div class="col-xl-12 col-lg-12 col-sm-12 Invoice-content-wrap">\n                    <a href="#" class="Invoice-item">\n                        <div class="Invoice-icon">\n                            <span class="material-icons material-icons-style material-icons-2">bar_chart</span>\n                        </div>\n                        <div class="Invoice-content">\n                            <h6 class="subtitle">This week</h6>\n                            <h3 class="title">'.concat(e.cweek,'</h3>\n                        </div>\n                        <div class="Invoice-icon2"></div>\n                    </a>\n                </div>\n            ')),0!==e.cyesterday&&(t+='\n                <div class="col-xl-12 col-lg-12 col-sm-12 Invoice-content-wrap">\n                    <a href="#" class="Invoice-item">\n                        <div class="Invoice-icon">\n                            <span class="material-icons material-icons-style material-icons-2">bar_chart</span>\n                        </div>\n                        <div class="Invoice-content">\n                            <h6 class="subtitle">Yesterday</h6>\n                            <h3 class="title">'.concat(e.cyesterday,'</h3>\n                        </div>\n                        <div class="Invoice-icon2"></div>\n                    </a>\n                </div>\n            ')),0!==e.ctoday&&(t+='\n                <div class="col-xl-12 col-lg-12 col-sm-12 Invoice-content-wrap">\n                    <a href="#" class="Invoice-item">\n                        <div class="Invoice-icon">\n                            <span class="material-icons material-icons-style material-icons-2">bar_chart</span>\n                        </div>\n                        <div class="Invoice-content">\n                            <h6 class="subtitle">Today</h6>\n                            <h3 class="title">'.concat(e.ctoday,'</h3>\n                        </div>\n                        <div class="Invoice-icon2"></div>\n                    </a>\n                </div>\n            ')),t}},{key:"getEntityChartsData",value:function(e,t){var n=this,a="/aspx/Analytics.aspx/GetAnalyticsChartsDataWS";"General"!=t&&(a="/aspx/Analytics.aspx/GetAnalyticsMultipleChartsDataWS"),$.ajax({url:top.window.location.href.toLowerCase().substring(0,top.window.location.href.toLowerCase().indexOf("/aspx/"))+a,type:"POST",cache:!1,async:!0,dataType:"json",data:JSON.stringify(e),contentType:"application/json",success:function(e){try{if((r=JSON.parse(e.d)).result.success)var a=JSON.parse(r.result.charts[0].data_json);if("General"==t){if(a.length>0){var i=a[0],o=_entity.generateGeneralKPIHTML(i);document.querySelector("#KPI-2 .row").innerHTML=o;var s=a&&a[0]?a[0].totrec:0;return void rowsCountHelper.setTotalRecords(s)}}else if(document.querySelector("#Homepage_CardsList_Wrapper").innerHTML="",a.length>0){var r;(r=JSON.parse(e.d)).result.success&&(n.chartsJson=r);try{var l=[];n.chartsJson.result.charts.forEach(function(e,t){var a=JSON.parse(e.data_json),i=n.getChartCriteria(a[0].criteria),o=JSON.parse(e.data_json).map(function(e){return{data_label:e.keyname,value:e.keyvalue}});l.push({chartsid:"chart"+t.toString(),charttype:"chart",chartjson:JSON.stringify(o),chartname:"".concat(n.getChartCaptions(i))})}),n.chartsJson=l}catch(f){return void console.log("Error in charts"+f)}}else handleNoChartData();callParentNew("LoadIframe");var c={},d={},u="",m="",p={dirLeft:!0,enableMasonry:!1,homePageType:"cards",isCardsDashboard:!0,isMobile:isMobileDevice()},h={css:[],js:[]};h.js.push("/ThirdParty/lodash.min.js"),h.js.push("/ThirdParty/deepdash.min.js"),h.js.push("/Js/handlebars.min.js?v=1"),h.js.push("/Js/handleBarsHelpers.min.js"),h.js.push("/ThirdParty/Highcharts/highcharts.js"),h.js.push("/ThirdParty/Highcharts/highcharts-3d.js"),h.js.push("/ThirdParty/Highcharts/highcharts-more.js"),h.js.push("/ThirdParty/Highcharts/highcharts-exporting.js"),h.js.push("/Js/analytics-charts-functions.min.js?v=24"),h.js.push("/Js/AxInterface.js?v=10"),h.js.push("/ThirdParty/DataTables-1.10.13/extensions/Extras/moment.min.js"),h.css.push("/ThirdParty/fullcalendar/lib/main.min.css"),h.js.push("/ThirdParty/fullcalendar/lib/main.min.js"),p.isMobile&&h.js.push("/ThirdParty/jquery-ui-touch-punch-master/jquery.ui.touch-punch.min.js"),p.enableMasonry&&h.js.push("/ThirdParty/masonry/masonry.pkgd.min.js"),h.js.push("/js/entity-charts.js?v=2"),document.getElementsByTagName("body")[0].classList.contains("btextDir-rtl")&&(p.dirLeft=!1),loadAndCall({files:h,callBack:function(){$(function(){ShowHideDimmer(!0),deepdash(_);if(c.value=JSON.stringify(_entity.chartsJson),d.value=JSON.stringify([]),""!=(u="")){u=u.replace(/'/g,"'");var e=parseXml(u),t=xml2json(e,"");m=JSON.parse(t)}appGlobalVarsObject._CONSTANTS.menuConfiguration=$.extend(!0,{},appGlobalVarsObject._CONSTANTS.menuConfiguration,{menuJson:m}),appGlobalVarsObject._CONSTANTS.cardsPage={setCards:!1,cards:[]},$.axpertUI.options.cardsPage.cards=[],appGlobalVarsObject._CONSTANTS.cardsPage=$.extend(!0,{},appGlobalVarsObject._CONSTANTS.cardsPage,{setCards:!0,cards:(JSON.parse(""!==c.value?ReverseCheckSpecialChars(c.value):"[]",function(e,t){try{return"object"===_typeof(t)||isNaN(t)||""===t.toString().trim()?t:"string"==typeof t&&(t.startsWith("0")||t.startsWith("-"))?parseFloat(t,10):JSON.parse(t)}catch(n){return t}})||[]).map(function(e){return _.mapKeys(e,function(e,t){return t.toString().toLowerCase()})}),design:(JSON.parse(""!==d.value?d.value:"[]",function(e,t){try{return"object"===_typeof(t)||isNaN(t)||""===t.toString().trim()?t:"string"==typeof t&&(t.startsWith("0")||t.startsWith("-"))?parseFloat(t,10):JSON.parse(t)}catch(n){return t}})||[]).map(function(e){return _.mapKeys(e,function(e,t){return t.toString().toLowerCase()})}),enableMasonry:p.enableMasonry,staging:{iframes:".splitter-wrapper",cardsFrame:{div:".cardsPageWrapper",cardsDiv:"#Homepage_CardsList_Wrapper",cardsDesigner:".cardsDesigner",cardsDesignerToolbar:".designer",editSaveButton:".editSaveCardDesign",icon:"span.material-icons",divControl:"#arrangeCards"}}});appGlobalVarsObject.lcm;var n=$.axpertUI.init({isHybrid:appGlobalVarsObject._CONSTANTS.isHybrid,isMobile:p.isMobile,compressedMode:appGlobalVarsObject._CONSTANTS.compressedMode,dirLeft:p.dirLeft,axpertUserSettings:{settings:appGlobalVarsObject._CONSTANTS.axpertUserSettings},cardsPage:appGlobalVarsObject._CONSTANTS.cardsPage});appGlobalVarsObject._CONSTANTS.cardsPage=n.cardsPage,ShowHideDimmer(!1)}),$.axpertUI.cardsPage._addCardHeader=function(e,t){e.find(".card-title").attr("title",t.chartname||"").find("headerContent").replaceWith(t.chartname||""),e.find(".card-header").attr("data-bs-target","#".concat(t.chartsid.replaceAll("~",""))),e.find(".KC_Items_Content").attr("id","".concat(t.chartsid.replaceAll("~",""))),e.attr("title",t.chartname||"");var n='<span class="material-icons material-icons-style" onclick="_entity.deleteChart(\''.concat(t.chartsid,"')\">close</span>");e.find("toolbarContent").replaceWith(n)}}})}catch(f){console.error("Error processing summary data:",f)}}})}},{key:"createChartsFieldsForSelection",value:function(){var e={GroupFld:{},AggFld:{}},t=document.querySelector("select#grpFld");this.metaData.filter(function(e){return"T"===e.grpfield&&"T"===e.listingfld}).forEach(function(n){var a=document.createElement("option");a.value=n.fldname,a.textContent="".concat(n.fldcap||"","(").concat(n.fldname,")"),t.appendChild(a),e.GroupFld[n.fldname]={cnd:n.cnd,fldcap:n.fldcap||"",fldname:n.fldname,normalized:n.normalized,allowempty:n.allowempty,srctable:n.srctable,srcfield:n.srcfield,tablename:n.tablename}});var n=document.querySelector("select#subEnt");if(n){var a=document.createElement("option");a.value=this.entityTransId,a.textContent="".concat(this.entityName,"(").concat(this.entityTransId,")"),n.appendChild(a)}var i=document.querySelector("select#aggFld");this.metaData.filter(function(e){return"T"===e.aggfield&&"T"===e.listingfld}).forEach(function(t){var n=document.createElement("option");n.value=t.fldname,n.textContent="".concat(t.fldcap||"","(").concat(t.fldname,")"),i.appendChild(n),e.AggFld[t.fldname]={cnd:t.cnd,fldcap:t.fldcap||"",fldname:t.fldname,normalized:t.normalized,allowempty:t.allowempty,srctable:t.srctable,srcfield:t.srcfield,tablename:t.tablename}}),document.getElementById("aggFld").addEventListener("change",function(){var e=document.getElementById("aggCond");"count"===this.value?(e.value=0,e.disabled=!0):(e.value="sum",e.disabled=!1)}),this.chartsMetaData=e}},{key:"getSelectedCharts",value:function(){document.getElementById("grpFld").value,document.getElementById("aggCond").value,document.getElementById("aggFld").value;var e={aggField:"count",aggFunc:"count",aggTransId:this.entityTransId,groupField:"all",groupTransId:this.entityTransId,page:"Entity",transId:this.entityTransId};if(this.getEntityChartsData(e,"General"),this.selectedChartsArr.length){var t={page:"Entity",transId:this.entityTransId,charts:this.selectedChartsArr};this.getEntityChartsData(t),document.querySelector(".NO-KPI-Items").classList.add("d-none")}else document.querySelector(".NO-KPI-Items").classList.remove("d-none");ShowHideDimmer()}},{key:"setSelectedCharts",value:function(){var e={page:"Entity",transId:this.entityTransId,properties:{CHARTS:JSON.stringify(this.selectedChartsArr)},confirmNeeded:!0,allUsers:!0};_entityCommon.setAnalyticsDataWS(e,function(){window.location.reload()},function(e){showAlertDialog("error",e.status+" "+e.statusText)})}},{key:"clearChartSelection",value:function(){if(confirm("Clear all Charts?")){this.selectedChartsArr=[],this.setSelectedCharts()}}},{key:"applyChartSelection",value:function(){var e=document.getElementById("grpFld").value,t=document.getElementById("aggCond").value,n=document.getElementById("aggFld").value;if("count"==n)t="count";else if("0"===t)return showAlertDialog("error","Select a valid Display function"),void document.getElementById("aggCond").focus();"0"===e&&(e="");var a={aggField:n,aggFunc:t,aggTransId:this.entityTransId,groupField:e,groupTransId:this.entityTransId,page:"Entity",transId:this.entityTransId},i={aggField:a.aggField,aggFunc:a.aggFunc,aggTransId:a.aggTransId,groupField:a.groupField,groupTransId:a.groupTransId};this.selectedChartsArr.push(i),this.setSelectedCharts(),document.querySelector(".NO-KPI-Items").classList.add("d-none")}},{key:"getChartCaptions",value:function(e){if(!this.selectedChartCaptions[e]){var t=e.split("~"),n=t[1],a=this.chartsMetaData.GroupFld[n],i=t[3],o=t[2],s=this.chartsMetaData.AggFld[o],r="";r="count"==i?"".concat(a.fldcap||""," wise ").concat(i):""!=n?"".concat(a.fldcap||""," wise ").concat(s.fldcap||"","(").concat(i,")"):"".concat(s.fldcap||"","(").concat(i,")"),this.selectedChartCaptions[e]=r}return this.selectedChartCaptions[e]}},{key:"filterByFldname",value:function(e,t){return e.filter(function(e){return e.fldname.toLowerCase()===t.toLowerCase()})}},{key:"setSelectedFields",value:function(){var e=this,t={page:"Entity",transId:e.entityTransId,properties:{KEYFIELD:e.keyField,FIELDS:e.fields},confirmNeeded:!0,allUsers:!1};_entityCommon.setAnalyticsDataWS(t,function(){e.reloadEntityPage()},function(e){console.error("Error in SetEntityFieldsWS:",e),ShowHideDimmer(!1)})}},{key:"constructCustomHyperLinkAccordions",value:function(){var e="";document.querySelector("#KPI-2").classList.remove("d-none"),document.querySelector(".right-customhyperlinks").classList.remove("d-none"),this.customHyperLinks.forEach(function(t){e+='<div class="cc-metrics-item">\n                    <div class="cc-metrics-label">                        \n                        <a href="javascript:void(0)" onclick="_entityCommon.navigateToUrl(\''.concat(t.link,"')\">").concat(t.hyperlinkcaption,"</a>\n                    </div>\n                </div>")}),$("#kt_accordion_connecteddata_hyperlinks .cc-metrics-list").append(e)}},{key:"reloadPage",value:function(){window.location.reload()}},{key:"deleteChart",value:function(e){if(confirm("Delete this chart?")){var t=e.replace("chart","");(t=parseInt(t))>-1&&this.selectedChartsArr.splice(t,1),this.setSelectedCharts()}}},{key:"showTimeLine",value:function(e,t){(axTimeLineObj=new ProcessTimeLine).keyvalue=t,axTimeLineObj.processName=e,this.inValid(axTimeLineObj.keyvalue)||"NA"==axTimeLineObj.keyvalue||axTimeLineObj.getTimeLineData()}},{key:"initCharts",value:function(){this.createChartsFieldsForSelection(),this.getSelectedCharts()}},{key:"bindEvents",value:function(){this.bindThemeEvent(),this.bindUtilityEvent(),document.querySelector("#fieldCaptionsMenuItem").addEventListener("click",function(e){e.preventDefault(),_entity.toggleCaptions()})}},{key:"openNewTstruct",value:function(){var e={page:"Entity",transId:this.entityTransId,recordId:"0",action:"Create"};return _entityCommon.getEntityEditableFlag(e)?(_entityCommon.loadHyperLink("../aspx/tstruct.aspx?transid=".concat(this.entityTransId,"&dummyload=false")),!0):(showAlertDialog("error","User does not have 'Create' access for this screen. Please check with administrator."),!1)}},{key:"editEntity",value:function(e,t){var n={page:"Entity",transId:this.entityTransId,recordId:e,action:"Edit"};if(_entityCommon.getEntityEditableFlag(n)){setDataListDictionary(t);var a="";a="1"==t?"first":t==this.listJson.length.toString()?"last":"middle";var i="../aspx/tstruct.aspx?transid=".concat(this.entityTransId,"&recordid=").concat(e,"&hltype=load&torecid=false&recPos=").concat(t,"&curPage=1&pageType=").concat(a,"&openerIV=").concat(this.entityTransId,"&isIV=false&isDupTab=false&dummyload=false");return _entityCommon.loadHyperLink(i),!0}return showAlertDialog("error","User does not have 'Edit' access for this record. Please check with administrator."),!1}},{key:"reloadEntityPage",value:function(){_entityCommon.loadHyperLink("../aspx/Entity.aspx?tstid=".concat(this.entityTransId))}},{key:"bindThemeEvent",value:function(){var e=this;document.querySelectorAll("#selectThemes .menu-link").forEach(function(t){t.addEventListener("click",function(n){n.preventDefault();var a=this.getAttribute("data-target");e.updateActiveClass(t);var i={page:"ENTITY",transId:e.entityTransId,properties:{THEME:a},confirmNeeded:!0,allUsers:!0};_entityCommon.setAnalyticsDataWS(i,function(){e.updateTheme(a)},function(e){console.error("Error in SetAnalyticsDataWS:",e),ShowHideDimmer(!1)})})})}},{key:"bindUtilityEvent",value:function(){var e=this;document.querySelectorAll("#exportMenuItem .menu-link").forEach(function(t){t.addEventListener("click",function(t){t.preventDefault();var n=this.getAttribute("data-target");e.handleUtilityAction(n)})})}},{key:"handleUtilityAction",value:function(e){handleExport(e,"#table-body_Container .table")}},{key:"applyTheme",value:function(){if(!this.tableViewFlag){var e=this.properties.THEME||"gradTheme";this.updateTheme(e);var t=document.querySelector('#selectThemes .menu-link[data-target="'.concat(e,'"]'));t&&this.updateActiveClass(t)}}},{key:"updateActiveClass",value:function(e){document.querySelectorAll("#selectThemes .menu-link").forEach(function(e){e.classList.remove("active")}),e.classList.add("active")}},{key:"updateTheme",value:function(e){var t=document.body;t.classList.remove("lightTheme","blackTheme","gradTheme","compactTheme"),"lightTheme"===e||"light"===e?t.classList.add("lightTheme"):"blackTheme"===e||"dark"===e?t.classList.add("blackTheme"):"gradTheme"===e||"gradient"===e||"system"===e?t.classList.add("gradTheme"):"compactTheme"!==e&&"pattern"!==e||t.classList.add("compactTheme")}},{key:"getNearestRecords",value:function(e){var t=this,n=t.listJson.filter(function(e){return!1===t.inValid(e[e.keycol])}),a=n.findIndex(function(t){return t.rno===e});if(-1===a)return[];var i=[];if(a>0){var o=_objectSpread(_objectSpread({},n[a-1]),{},{navtype:"prev"});i.push(o)}var s=_objectSpread(_objectSpread({},n[a]),{},{navtype:"current"});if(i.push(s),a<n.length-1){var r=_objectSpread(_objectSpread({},n[a+1]),{},{navtype:"next"});i.push(r)}return i}},{key:"openHyperLinks",value:function(){$("#hyperlinksConfigModal").modal("show"),$("#hyperlinksConfigModal").hasClass("content-loaded")||this.createHyperLinkLayout()}},{key:"closeHyperLinks",value:function(){$("#hyperlinksConfigModal").modal("hide")}},{key:"createHyperLinkLayout",value:function(){this.constructCustomHyperlinksContainer(),$("#hyperlinksConfigModal").addClass("content-loaded")}},{key:"constructCustomHyperlinksContainer",value:function(){var e,t=$("#hyperlinkGridBody"),n=$("#addRowBtn");function a(){var e=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{},n='\n                    <tr>\n                        <td class="serial-number">'.concat(t.find("tr").length+1,'</td>\n                        <td>\n                            <input type="text" class="form-control hyperlink-name" \n                                   placeholder="Hyperlink Name" \n                                   value="').concat(e.hyperlinkcaption||"",'" required>\n                        </td>\n                        <td>\n                            <input type="text" class="form-control link-url" \n                                   placeholder="Enter Link" \n                                   value="').concat(e.link||"",'" required>\n                        </td>\n                        <td class="text-center">\n                            <button class="btn btn-sm delete-row" type="button">\n                                <i class="material-icons">delete</i>\n                            </button>\n                        </td>\n                    </tr>\n                ');t.append(n),i()}if(a(),(null===(e=this.customHyperLinks)||void 0===e?void 0:e.length)>0)try{t.empty(),rowCount=0,this.customHyperLinks.forEach(function(e){a(e)})}catch(o){alert("Invalid JSON: "+o.message)}function i(){t.find(".delete-row").prop("disabled",t.find("tr").length<=1)}n.on("click",function(){a()}),t.on("click",".delete-row",function(){t.find("tr").length>1&&($(this).closest("tr").remove(),t.find("tr").each(function(e){$(this).find(".serial-number").text(e+1)}),i())})}},{key:"getCustomHyperLinksJSON",value:function(){var e=$("#hyperlinkGridBody"),t=[];return e.find("tr").each(function(){var e=$(this).find(".hyperlink-name").val().trim(),n=$(this).find(".link-url").val().trim();e&&n&&t.push({hyperlinkcaption:e,link:n})}),t}},{key:"resetHyperLinks",value:function(){if(confirm("Reset the selections?")){var e=this,t={page:"ENTITY",transId:e.entityTransId,properties:{CONFIG:JSON.stringify({HYPERLINKS:[]})},confirmNeeded:!0,allUsers:!0};_entityCommon.setAnalyticsDataWS(t,function(){showAlertDialog("success","Changes applied successfully"),e.reloadEntityPage()},function(e){showAlertDialog("error",e.status+" "+e.statusText)})}}},{key:"applyHyperLinks",value:function(){var e=this,t={page:"ENTITY",transId:e.entityTransId,properties:{CONFIG:JSON.stringify({HYPERLINKS:e.getCustomHyperLinksJSON()||[]})},confirmNeeded:!0,allUsers:!0};_entityCommon.setAnalyticsDataWS(t,function(){showAlertDialog("success","Changes applied successfully"),e.reloadEntityPage()},function(e){showAlertDialog("error",e.status+" "+e.statusText)})}},{key:"callAPI",value:function(e,t,n,a){var i=this,o=new XMLHttpRequest;o.open("POST",e,n),o.setRequestHeader("Content-Type","application/json;charset=UTF-8"),i.isAxpertFlutter&&(o.setRequestHeader("Authorization","Bearer ".concat(armToken)),t.armSessionId=armSessionId),o.onreadystatechange=function(){4==this.readyState&&(200==this.status?a({success:!0,response:this.responseText}):(i.catchError(this.responseText),a({success:!1,response:this.responseText})))},o.send(JSON.stringify(t))}},{key:"catchError",value:function(e){showAlertDialog("error",e)}},{key:"showSuccess",value:function(e){showAlertDialog("success",e)}},{key:"dataConvert",value:function(e,t){if("AXPERT"==t)try{if("undefined"!=typeof(e=JSON.parse(e.d)).result[0].result.row)return e.result[0].result.row;if("undefined"!=typeof e.result[0].result)return e.result[0].result}catch(n){ShowHideDimmer(!1),this.catchError(n.message)}else if("ARM"==t)try{if(this.isAxpertFlutter||(e=JSON.parse(e.d)),e.result&&e.result.success){if(!this.isUndefined(e.result.data))return e.result.data}else this.isUndefined(e.result.message)||this.catchError(e.result.message)}catch(n){ShowHideDimmer(!1),this.catchError(n.message)}return e}},{key:"generateFldId",value:function(){return"fid".concat(Date.now()).concat(Math.floor(9e4*Math.random())+1e4)}},{key:"isEmpty",value:function(e){return""==e}},{key:"isNull",value:function(e){return null==e}},{key:"isNullOrEmpty",value:function(e){return null==e||""==e}},{key:"inValid",value:function(e){return null==e||void 0===e||""==e}},{key:"isUndefined",value:function(e){return void 0===e}}]),e}(),Field=_createClass(function e(t){_classCallCheck(this,e),this.fldcap=t.fldcap||"",this.fldname=t.fldname,this.cdatatype=t.cdatatype,this.fdatatype=t.fdatatype,this.moe=t.moe,this.hide=t.hide,this.props=t.props}),EntityMetaData=_createClass(function t(e){if(_classCallCheck(this,t),!e||!Array.isArray(e))throw new Error("Invalid JSON data");this.metadata=e.map(function(e){return new Field(e)})}),axTimeLineObj;function createListHTML(e,t){var n=$("#body_Container");isCardView||n.html("");var a="",i=filterRowsByPage(e,t),o=[],s=[],r=[],l=[];$.each(_entity.metaData,function(e,t){if("T"===t.hide)return!0;var n=getFieldDataType(t).toUpperCase();"BUTTON"===n?l.push(t):"ATTACHMENTS"===n?s.push(t):"LARGE TEXT"===n?o.push(t):r.push(t)});var c,d=_entity.keyField,u=!1;_entity.navigationRecords=[],e.forEach(function(e,t){_entity.navigationRecords.push(e.recordid)});var m,p=_createForOfIteratorHelper(i);try{for(p.s();!(m=p.n()).done;){var h,f,y=m.value;if(!y.hasOwnProperty(d.toLowerCase())){var v=getKeyField();d=v?v.fldname:_entity.keyField}y.keycol=d,u=!0,a+='<div class="Project_items" id="row_'.concat(y.recordid,'">\n            <div class="card">\n                <div class="col-xl-12 col-md-12 d-flex flex-column flex-column-fluid">');var g=null!==(h=null===(f=y[d.toLowerCase()])||void 0===f?void 0:f.toString())&&void 0!==h?h:"";if(c||(c=_entity.metaData.find(function(e){return e.fldname.toLowerCase()==d.toLowerCase()})),"d"!==c.fdatatype&&"Date"!==c.cdatatype||(g=formatDateString(g)),a+=' <div class="page-Header">\n                    <h3 class="card-title collapsible cursor-pointer rotate" data-bs-toggle="collapse"\n                        aria-expanded="true" data-bs-target="#Sub-Entity_wrapper" >\n                        <input class="Select-Project" type="checkbox" id="checkbox_'.concat(y.recordid,'" data-recordid="').concat(y.recordid,'" value="">\n                        <span class="Project_title" onclick="_entity.openEntityForm(\'').concat(_entity.entityName,"', '").concat(y.transid,"', '").concat(y.recordid,"', '").concat(g.replace(/\\/g,"\\\\"),"', ").concat(y.rno,')">').concat(_entityCommon.inValid(g)?"--":g.replace(/\\/g,"\\\\"),'</span>\n                        <input type="hidden" class="transid" id="transid_').concat(y.recordid,'" value="').concat(y.transid,'"/>\n                        <input type="hidden" class="recid" id="recid_').concat(y.recordid,'" value="').concat(y.recordid,'"/>\n                        <div class="Project_updates">\n                        </div>\n                    </h3>\n                    <div id="" class="card-toolbar">\n                        <div class="d-flex">\n                            <div class="edit-container">\n                                <button type="button" id=""\n                                    class="btn btn-icon btn-white btn-color-gray-600 btn-active-primary shadow-sm tb-btn btn-sm me-3"\n                                    data-bs-toggle="tooltip" title="Edit" data-bs-original-title="Edit"\n                                    onclick="return _entity.editEntity(\'').concat(y.recordid,"','").concat(y.rno,'\')">\n                                    <span class="material-icons material-icons-style material-icons-2" style="color: red;">\n                                        edit_note\n                                    </span>\n                                </button>\n                            </div>\n                            <button type="submit" id=""\n                                class="btn btn-icon btn-white btn-color-gray-600 btn-active-primary shadow-sm tb-btn btn-sm me-3 d-none"\n                                data-bs-toggle="tooltip" title="" data-bs-original-title="Options">\n                                <span class="material-icons material-icons-style material-icons-2" style="color: #47BE7D;">\n                                    more_vert\n                                </span>\n                            </button>\n                        </div>\n                    </div>\n                </div>'),!(_entity.inValid(y.modifiedby)||_entity.inValid(y.modifiedon)||_entity.inValid(y.createdby)||_entity.inValid(y.createdon))){var b=moment(y.modifiedon).format("DD/MM/YYYY"),w=moment(y.modifiedon).format("HH:mm:ss"),C=moment(y.modifiedon).fromNow(),T=moment(y.createdon).format("DD/MM/YYYY"),_=moment(y.createdon).format("HH:mm:ss"),k=moment(y.createdon).fromNow(),E="",S="",I="",x="";_entity.modificationFields.includes("modifiedby")&&y.modifiedby&&(E="Modified by: ".concat(y.modifiedby)),_entity.modificationFields.includes("createdby")&&y.createdby&&(I="Created by: ".concat(y.createdby)),_entity.modificationFields.includes("modifiedon")&&y.modifiedon&&(S="Modified on: ".concat(b," ").concat(w)),_entity.modificationFields.includes("createdon")&&y.createdon&&(x="Created on: ".concat(T," ").concat(_));var L="";_entity.modificationFields.includes("createdby")&&_entity.modificationFields.includes("modifiedby")?L="".concat(E,"\n").concat(I):_entity.modificationFields.includes("createdby")&&!_entity.modificationFields.includes("modifiedby")?L=I:!_entity.modificationFields.includes("createdby")&&_entity.modificationFields.includes("modifiedby")&&(L=E),a+='<div class="workflow-container" style="display: flex; align-items: center;">\n                                <div class="workflow-row" style="display: flex; align-items: center;">\n                                    <div class="workflow-items" style="display: flex; align-items: center;">',L&&(a+='<div class="symbol symbol-25px symbol-circle initialized" data-bs-toggle="tooltip" title="'.concat(L,'" data-bs-original-title="').concat(L,'">\n                                    <span class="symbol-label bg-warning text-inverse-warning fw-bold">').concat(y.modifiedby[0],"</span>\n                                    </div>")),_entity.modificationFields.includes("createdby")&&_entity.modificationFields.includes("modifiedby")?a+='<span data-toggle="tooltip" title="'.concat(L,'" class="Project_updates-value" style="margin-left: 10px;">\n                                    ').concat(y.modifiedby.split("@")[0],"\n                                    </span>"):_entity.modificationFields.includes("createdby")&&!_entity.modificationFields.includes("modifiedby")?a+='<span data-toggle="tooltip" title="'.concat(L,'" class="Project_updates-value" style="margin-left: 10px;">\n                                    ').concat(y.createdby.split("@")[0],"\n                                    </span>"):!_entity.modificationFields.includes("createdby")&&_entity.modificationFields.includes("modifiedby")&&(a+='<span data-toggle="tooltip" title="'.concat(L,'" class="Project_updates-value" style="margin-left: 10px;">\n                                    ').concat(y.modifiedby.split("@")[0],"\n                                    </span>")),L="",_entity.modificationFields.includes("createdon")&&_entity.modificationFields.includes("modifiedon")?L="".concat(S,"\n").concat(x):_entity.modificationFields.includes("createdon")&&!_entity.modificationFields.includes("modifiedon")?L=x:!_entity.modificationFields.includes("createdon")&&_entity.modificationFields.includes("modifiedon")&&(L=S),L?a+='<span class="Project_updates-value" data-toggle="tooltip" data-placement="top" title="'.concat(L,'" \n                                        data-name="').concat(b," ").concat(w,'" style="margin-left: 10px;">\n                                        last modified ').concat(C,"\n                                    </span>"):_entity.modificationFields.includes("createdon")&&!_entity.modificationFields.includes("modifiedon")?a+='<span class="Project_updates-value" data-toggle="tooltip" data-placement="top" title="'.concat(x,'" \n                                        data-name="').concat(T," ").concat(_,'" style="margin-left: 10px;">\n                                        created on: ').concat(k,"\n                                    </span>"):!_entity.modificationFields.includes("createdon")&&_entity.modificationFields.includes("modifiedon")&&(a+='<span class="Project_updates-value" data-toggle="tooltip" data-placement="top" title="'.concat(S,'" \n                                        data-name="').concat(b," ").concat(w,'" style="margin-left: 10px;">\n                                        last modified ').concat(C,"\n                                    </span>")),a+="</div></div>",y.axpeg_status&&""!==y.axpeg_status.toString()&&"0"!==y.axpeg_status.toString()&&(a+='<div class="status-timeline" style="display: flex; align-items: center; margin-left: 20px;">\n                                    <span class="material-icons material-icons-style material-icons-2" style="margin-right: 10px; margin-bottom: 10px;">people</span>\n                                    <button id="pd_timeline" class="btn btn-icon btn-white btn-color-gray-600 btn-active-primary shadow-sm tb-btn btn-sm entity-timelines" \n                                            data-kt-menu-trigger="click" data-kt-menu-placement="bottom-end" \n                                            data-kt-menu-flip="top-end" data-kt-menu-attach="parent" title="Timeline" \n                                            style="margin-right: 10px; margin-bottom: 10px;">\n                                        <span class="material-icons material-icons-style material-icons-2">history</span>\n                                    </button>\n                                    <div class="menu menu-sub menu-sub-dropdown menu-column menu-rounded menu-gray-600 menu-state-bg-light fw-bolder w-400px py-3" \n                                            data-kt-menu="true" data-id="pd_timeline" \n                                            data-processname="'.concat(y.axpeg_processname,'" data-keyvalue="').concat(y.axpeg_keyvalue,'">\n                                    </div>\n                                </div>')),a+="</div>"}a+=generateRowElements(r,o,s,y),a+=generateRowButtonHTML(l,y),a+="</div></div></div>"}}catch(A){p.e(A)}finally{p.f()}i.length&&!u?n.append(this.nullRowsHtml):""!==a?(n.append(a),initReadMore(),KTMenu.init(),document.querySelectorAll(".entity-timelines").forEach(function(e){KTMenu.getInstance(e).on("kt.menu.dropdown.show",function(e){var t=KTMenu.getInstance(e).element;t.innerHTML='<div id="TimeLine_overall" class="content">\n                        <div class="card" id="Timeline-wrap">\n                            <h1 class="Timeline-heading">Timeline</h1>\n                            <ul class="Timel-sessions full-session d-none"></ul>\n                            <span id="nodata" class="p-5">No Timeline data available.</span>\n                        </div>\n                    </div>';var n=t.dataset;_entity.showTimeLine(n.processname,n.keyvalue)}),KTMenu.getInstance(e).on("kt.menu.dropdown.hide",function(e){KTMenu.getInstance(e).element.innerHTML=""})})):n.append(this.emptyRowsHtml)}function generateRowElements(e,t,n,a){var i,o='<div class="Data-fields-row">',s=_createForOfIteratorHelper(e);try{for(s.s();!(i=s.n()).done;){var r=i.value;r.fldname.toLowerCase()!=a.keycol.toLowerCase()&&(o+=_entity.generateHTMLBasedOnDataType(r,a))}}catch(h){s.e(h)}finally{s.f()}var l,c=_createForOfIteratorHelper(t);try{for(c.s();!(l=c.n()).done;){var d=l.value;d.fldname.toLowerCase()!=a.keycol.toLowerCase()&&(o+=_entity.generateHTMLBasedOnDataType(d,a))}}catch(h){c.e(h)}finally{c.f()}var u,m=_createForOfIteratorHelper(n);try{for(m.s();!(u=m.n()).done;){var p=u.value;o+=_entity.generateHTMLBasedOnDataType(p,a)}}catch(h){m.e(h)}finally{m.f()}return o+="</div>"}function generateRowButtonHTML(e,t){var n,a='<div class="Action-Btns-row ">\n                                            <div class="d-flex align-items-center ">\n                                                <a href="javascript:void(0)" title="Approve"\n                                                   onclick="axTasksObj.doApprove(\'1409660000003\', this);"\n                                                   class="btn btn-white btn-sm btn-color-gray-700 btn-active-primary d-inline-flex align-items-center  btn-sm  me-2  ">\n                                                    <span class="material-icons material-icons-style material-icons-2"\n                                                          style="color: #47BE7D;">visibility</span>View form\n                                                </a>\n                                                <a href="javascript:void(0)" title="Reject"\n                                                   class="btn btn-white btn-color-gray-700 btn-active-primary d-inline-flex align-items-center  me-2  btn-sm"\n                                                   onclick="axTasksObj.doReject(\'1409660000003\', this)">\n                                                    <span class="material-icons material-icons-style material-icons-2"\n                                                          style="color: red;">edit_note</span>Edit Form\n                                                </a>',i=_createForOfIteratorHelper(e);try{for(i.s();!(n=i.n()).done;){var o=n.value;a+=_entity.generateHTMLBasedOnDataType(o,t)}}catch(s){i.e(s)}finally{i.f()}return a+=" </div>\n                                        </div>"}function parseFilePath(e){var t=/^(.*[\\\/])([^\\\/]+)\.(\w+)$/.exec(e),n={folder:"",ext:"",filename:""};return t?(n.folder=t[1],n.filename=t[2],n.ext=t[3]):n.folder=e,n}function downloadFileFromPath(e,t){$.ajax({type:"POST",url:top.window.location.href.toLowerCase().substring(0,top.window.location.href.indexOf("/aspx/"))+"/customwebservice.asmx/GetAttachments",cache:!1,async:!1,contentType:"application/json;charset=utf-8",data:JSON.stringify({filePath:e,fileName:t}),dataType:"json",success:function(e){if("File not exists"!==e.d){var n=e.d.split(".").pop().toLowerCase();downloadAttachment(e.d,t,n)}else parent.showAlertDialog("error",e.d)},error:function(e){parent.showAlertDialog("error",e.d)}})}function isScrollAtBottomWithinDiv(e){return e.scrollHeight-(e.scrollTop+e.clientHeight)<=100}function isScrollAtTopWithinDiv(e){return e.scrollTop<=1}function filterRowsByPage(e,t){return e.filter(function(e){var n;return(null===(n=e.pageno)||void 0===n?void 0:n.toString())===(null==t?void 0:t.toString())})}function initReadMore(){document.querySelectorAll(".moretext").forEach(function(e,t){var n=e.clientHeight,a=e.nextElementSibling;e.scrollHeight>e.clientHeight?(a.style.display="inline-block",e.style.maxHeight=n+"px"):a.style.display="none",a.addEventListener("click",function(){var t=window.getComputedStyle(e);"none"===t.maxHeight||t.maxHeight===n+"px"?(e.style.maxHeight=e.scrollHeight+"px",a.textContent="Read less"):(e.style.maxHeight=n+"px",a.textContent="Read more")})})}function getFilesHtml(e){var t="",n=e.axpfile_file.split(",");return $.each(n,function(n,a){var i=getFileType(a),o=getIconClass(i),s=e.axpfilepath_file+a;s=s.replace(/\\/g,"\\\\"),""!=a&&(t+='<div class="Files-Attached ">\n\t\t\t\t\t\t   \x3c!--begin::Icon--\x3e\t\n\t\t\t\t\t\t   '.concat(o,'\t\t\t\t\t\t   \n\t\t\t\t\t\t   \x3c!--end::Icon--\x3e                     \n\t\t\t\t\t\t   \x3c!--begin::Info--\x3e\n\t\t\t\t\t\t   <div class="ms-1 fw-semibold">\n\t\t\t\t\t\t\t  \x3c!--begin::Desc--\x3e\t\t\t\t\t\t\t  \n\t\t\t\t\t\t\t  <a class="attached-filename" onclick="downloadFileFromPath(\'').concat(s,"','").concat(a,"')\">").concat(a,'</a>\n\t\t\t\t\t\t\t  \x3c!--end::Desc--\x3e                     \n\t\t\t\t\t\t\t  \x3c!--begin::Number--\x3e\n\t\t\t\t\t\t\t  <div class="attached-filedetails">\n\t\t\t\t\t\t\t\t <span class="doctype">').concat(i,'</span>\n\t\t\t\t\t\t\t\t \x3c!--<span class="docsize">1.9mb</span>--\x3e\n\t\t\t\t\t\t\t  </div>\n\t\t\t\t\t\t\t  \x3c!--end::Number--\x3e\n\t\t\t\t\t\t   </div>\n\t\t\t\t\t\t   <a class="attached-filename" onclick="downloadFileFromPath(\'').concat(s,"','").concat(a,'\')">\n\t\t\t\t\t\t\t   <span\n\t\t\t\t\t\t\t\t  class="material-icons material-icons-style material-icons-2 text-danger">cloud_download</span>\n\t\t\t\t\t\t\t</a>\n\t\t\t\t\t\t   \x3c!--begin::Info--\x3e\n\t\t\t\t\t\t</div>'))}),t}function getIconClass(e){switch(e){case"pdf":return'<img src="../images/pdf.svg" class="file-img" />';case"jpeg":case"jpg":case"png":return'<img src="../images/images.svg" class="file-img" />';case"doc":case"docx":return'<img src="../images/word.svg" class="file-img" />';case"txt":return'<i style="margin:0px !important; font-size: 40px !important; " class="material-icons">description</i>';case"xls":case"xlsx":return'<img src="../images/xl.svg" class="file-img"/>';case"ppt":case"pptx":return'<img src="../images/ppt.svg" class="file-img"/>';case"zip":return'<i style="margin:0px !important; font-size: 40px !important; " class="material-icons">archive</i>';case"mp3":return'<i style="margin:0px !important; font-size: 40px !important; " class="material-icons">audiotrack</i>';case"mp4":return'<i style="margin:0px !important; font-size: 40px !important; " class="material-icons">videocam</i>';default:return'<i style="margin:0px !important; font-size: 40px !important; " class="material-icons">insert_drive_file</i>'}}function getFileType(e){var t=e.split(".");return t[t.length-1].toLowerCase()}function scrollToTopOfDiv(e){e.scrollTop=0}$(document).ready(function(){_entityFilter=new EntityFilter,_entityCommon=new EntityCommon,(_entity=new Entity).init(),_entityFilter.metaData=_entity.metaData,_entityFilter.pageName="Entity",_entityFilter.entityTransId=_entity.entityTransId,_entityFilter.checkUrlFilters(),_entityFilter.applyFilters=function(){_entityFilter.activeFilterArray.forEach(function(e){if("DATE"===e.datatype.toUpperCase()&&"customOption"!==e.condition){var t=_entityCommon.getDatesBasedonSelectionForBetweenFilter(e.condition);e.from=t.from,e.to=t.to}}),_entity.filter=_entityFilter.activeFilterArray,_entity.getEntityListData(1),$("#filterModal").modal("hide")}});var ProcessTimeLine=function(){function e(){_classCallCheck(this,e),this.keyvalue="",this.processName="",this.make='<li class="make">                                   \n                    <p class="T-Desc">{{taskname}}#{{keyvalue}}</p>\n \t\t    <p class="T-Heading">{{taskfromuser}}</p>\n \t\t    <div class="time">{{tasktime}}</div>\n                </li>',this.check='<li class="check">\n                    <p class="T-Desc">{{taskname}}#{{keyvalue}} - {{taskstatus}}</p>\n                    <p class="T-Heading">{{taskfromuser}}</p>                    \n\t\t    <div class="time">{{tasktime}}</div>\n                </li>',this.approve='<li class="approve">\n                   <p class="T-Desc">{{taskname}}#{{keyvalue}} - {{taskstatus}}</p>\n                    <p class="T-Heading">{{taskfromuser}}</p>                    \n\t\t    <div class="time">{{tasktime}}</div>\n                </li>'}return _createClass(e,[{key:"getTimeLineData",value:function(){ShowHideDimmer(!0);var e=this,t={keyValue:e.keyvalue,processName:e.processName};this.callAPI("../aspx/AxPEG.aspx/AxGetTimelineData",t,!1,function(t){if(t.success){var n=JSON.parse(t.response),a=e.dataConvert(n,"ARM");e.constructTimeline(a),ShowHideDimmer(!1)}else ShowHideDimmer(!1)})}},{key:"constructTimeline",value:function(e){var t=this;if(this.isUndefined(e)||0==e.length)document.querySelector(".Timel-sessions").classList.add("d-none"),document.querySelector("#nodata").classList.remove("d-none");else{document.querySelector("#nodata").classList.add("d-none"),document.querySelector(".Timel-sessions").classList.remove("d-none");var n="";document.querySelector(".Timel-sessions").innerHTML="",e.forEach(function(e){n+=Handlebars.compile(t[e.tasktype.toLowerCase()])(e)}),document.querySelector(".Timel-sessions").insertAdjacentHTML("beforeend",n)}}},{key:"callAPI",value:function(e,t,n,a){var i=this,o=new XMLHttpRequest;o.open("POST",e,n),o.setRequestHeader("Content-Type","application/json;charset=UTF-8"),i.isAxpertFlutter&&(o.setRequestHeader("Authorization","Bearer ".concat(armToken)),t.armSessionId=armSessionId),o.onreadystatechange=function(){4==this.readyState&&(200==this.status?a({success:!0,response:this.responseText}):(i.catchError(this.responseText),a({success:!1,response:this.responseText})))},o.send(JSON.stringify(t))}},{key:"catchError",value:function(e){showAlertDialog("error",e)}},{key:"showSuccess",value:function(e){showAlertDialog("success",e)}},{key:"dataConvert",value:function(e,t){if("AXPERT"==t)try{if("undefined"!=typeof(e=JSON.parse(e.d)).result[0].result.row)return e.result[0].result.row;if("undefined"!=typeof e.result[0].result)return e.result[0].result}catch(n){this.catchError(n.message)}else if("ARM"==t)try{if(this.isAxpertFlutter||(e=JSON.parse(e.d)),e.result&&e.result.success){if(!this.isUndefined(e.result.data))return e.result.data}else this.isUndefined(e.result.message)||this.catchError(e.result.message)}catch(n){this.catchError(n.message)}return e}},{key:"generateFldId",value:function(){return"fid".concat(Date.now()).concat(Math.floor(9e4*Math.random())+1e4)}},{key:"isEmpty",value:function(e){return""==e}},{key:"isNull",value:function(e){return null==e}},{key:"isNullOrEmpty",value:function(e){return null==e||""==e}},{key:"isUndefined",value:function(e){return void 0===e}},{key:"inValid",value:function(e){return null==e||void 0===e||""==e}}]),e}();function showPopup(e){var t=e.getAttribute("data-text");document.getElementById("popupText").textContent=t,$("#myModal").modal("show")}function formatDateString(e){if(!e)return"";var t,n=(e=e.replaceAll("T"," ")).split(" ");if(3==n[0].split("-").length?t=n[0].split("-"):3==n[0].split("/").length&&(t=n[0].split("/")),3==t.length){var a,i,o,s=(n[1]||"00:00:00").split(":");4==t[0].length?(a=t[0],i=t[1],o=t[2]):(a=t[2],i=t[1],o=t[0]);var r=s[0],l=s[1],c=s[2],d="en-us"===dtCulture?"".concat(i,"/").concat(o,"/").concat(a):"".concat(o,"/").concat(i,"/").concat(a),u="00"!==r||"00"!==l||"00"!==c?"".concat(r,":").concat(l,":").concat(c):"";return u?"".concat(d," ").concat(u):d}}function openFieldSelection(){$("#fieldsModal").modal("show"),""==$("#fields-selection").html()&&createFieldsLayout()}function createFieldsLayout(){var e=document.getElementById("fields-selection"),t=["transid","modifiedby","modifiedon","createdby","createdon","username","axpeg_nextlevel"],n=_entity.metaData.filter(function(e){return e.ftransid===_entity.entityTransId&&"F"===e.hide&&"F"==e.griddc&&-1==t.indexOf(e.fldname.toLowerCase())&&"Image"!=e.cdatatype}),a={};n.forEach(function(e){e.dcname&&(a[e.dcname]||(a[e.dcname]=[]),a[e.dcname].push(e))});var i="";Object.entries(a).forEach(function(e){var t=_slicedToArray(e,2),n=t[0],a=t[1],o=_entity.metaData.find(function(e){return e.dcname==n}).dccaption||n,s="dc1"!==n;i+='\n        <div class="card KC_Items">\n            <div class="card-header collapsible cursor-pointer rotate '.concat(s?"collapsed":"",'" data-bs-toggle="collapse" aria-expanded="true" data-bs-target="#fields-').concat(n,'">\n                <h3 class="card-title">').concat(o," (").concat(n,')</h3>\n                <div class="card-toolbar rotate-180">\n                    <span class="material-icons material-icons-style material-icons-2">\n                        expand_circle_down\n                    </span>\n                </div>\n            </div>\n            <div class="KC_Items_Content collapse ').concat(s?"":"show",' heightControl pt-0---" id="fields-').concat(n,'">\n            <table class="table table-hover">\n                <tbody id="fields-table-body-').concat(n,'">'),a.forEach(function(e){i+='<tr id="row_'.concat(e.fldname,'" draggable="true" ondragstart="drag(event)" ondrop="drop(event)" ondragover="allowDrop(event)">\n                        <td>\n                            <input type="checkbox" id="chk_').concat(e.fldname,'" class="chk-fields chk-relateddataflds" value="').concat(e.fldname,'" data-fldcap="').concat(e.fldcap,'" data-dcname="').concat(n,'">\n                        </td>\n                        <td><label for="chk_').concat(e.fldname,'">').concat(e.fldcap||"","  (").concat(e.fldname,')</label></td>\n                        <td>\n                            <span class="drag-icon material-icons material-icons-style material-icons-2" data-bs-toggle="tooltip" title="Drag and change the order" style="display: none; cursor: move;">\n                                drag_indicator\n                            </span>\n                        </td>\n                     </tr>')}),i+="</tbody></table></div></div>"}),i+='\n    <div class="card KC_Items">\n        <div class="card-header">\n            <h3 class="card-title">Modification Info</h3>\n        </div>\n        <div class="KC_Items_Content">\n            <table class="table table-hover">\n                <tbody>\n                    <tr><td><input type="checkbox" id="chk_modifiedby" class="chk-fields chk-modification" value="modifiedby"></td><td><label for="chk_modifiedby">Modified By</label></td></tr>\n                    <tr><td><input type="checkbox" id="chk_modifiedon" class="chk-fields chk-modification" value="modifiedon"></td><td><label for="chk_modifiedon">Modified On</label></td></tr>\n                    <tr><td><input type="checkbox" id="chk_createdby" class="chk-fields chk-modification" value="createdby"></td><td><label for="chk_createdby">Created By</label></td></tr>\n                    <tr><td><input type="checkbox" id="chk_createdon" class="chk-fields chk-modification" value="createdon"></td><td><label for="chk_createdon">Created On</label></td></tr>\n                </tbody>\n            </table>\n        </div>\n    </div>',e.innerHTML=i;var o=document.querySelectorAll(".chk-fields");if("All"!=_entity.fields){_entity.fields.split(",").forEach(function(e){document.querySelector("#chk_".concat(e))&&(document.querySelector("#chk_".concat(e)).checked=!0)}),o.length==_entity.fields.split(",").length&&(document.querySelector("#check-all").checked=!0);var s=_entity.modificationFields?_entity.modificationFields.split(","):[];document.querySelectorAll(".chk-modification").forEach(function(e){e.checked=!1}),s.forEach(function(e){var t=document.querySelector('.chk-modification[value="'.concat(e,'"]'));t&&(t.checked=!0)})}else o.forEach(function(e){"dc1"==e.dataset.dcname&&(e.checked=!0)}),document.querySelectorAll(".chk-modification").forEach(function(e){e.checked=!0}),_entity.keyField=o[0].value;document.querySelector("#check-all").addEventListener("change",function(){var e=this.checked;o.forEach(function(t){t.checked=e});var t=Array.from(o).filter(function(e){return e.checked}).map(function(e){return e.value});_entity.fields=t.join(",")}),updateSelectOptions()}function updateSelectOptions(){var e=document.getElementById("selectField");e.innerHTML="";var t=document.querySelectorAll(".chk-fields");t.forEach(function(t){if(t.checked){var n=t.dataset.fldcap||"",a=document.createElement("option");a.textContent=n,a.value=t.value,e.appendChild(a)}}),e.disabled=!_toConsumableArray(t).some(function(e){return e.checked}),e.value=_entity.keyField}function applyFields(){var e=document.querySelectorAll(".chk-fields:checked");if(0!==e.length){var t=document.getElementById("selectField");if(0!==t.value&&""!==t.value){var n=[];e.forEach(function(e){n.push(e.value)});var a=n.join(",");_entity.fields=a,_entity.keyField=t.value,_entity.setSelectedFields()}else showAlertDialog("error","Error: Key Field is not selected.")}else showAlertDialog("error","Error: No fields are selected.")}function resetFields(){document.querySelectorAll(".chk-fields, #check-all");var e={page:"Entity",transId:_entity.entityTransId,properties:{FIELDS:"",KEYFIELD:""},confirmNeeded:!0,allUsers:!1};_entityCommon.setAnalyticsDataWS(e,function(){_entity.reloadEntityPage(),console.log("Fields reset to default values")},function(e){showAlertDialog("error",e.status+" "+e.statusText)})}function fieldsModelClose(){$("#fieldsModal").modal("hide")}function getFieldDataType(e){return _entity.inValid(e.cdatatype)?"n"==e.fdatatype?"Number":"d"==e.fdatatype?"Date":"c"==e.fdatatype?"Text":"i"==e.fdatatype?"Image":"t"==e.fdatatype?"Large Text":"Text":e.cdatatype}function getKeyField(){var e=_entity.fields.split(","),t=_entity.metaData.filter(function(t){return"T"===t.listingfld&&"T"!=t.hide&&("All"==_entity.fields&&"dc1"==t.dcname||e.indexOf(t.fldname)>-1)}),n=t.find(function(e){return"Auto Generate"===e.cdatatype});if(n)return n;var a=t.find(function(e){return"F"===e.hide&&"F"===e.allowempty&&"F"===e.allowduplicate});if(a)return a;var i=t.find(function(e){return"F"===e.hide&&"F"===e.allowempty});if(i)return i;var o=t.find(function(e){return"F"===e.hide});return o||t[0]}function getARMLogs(){var e=document.getElementById("logs-table-container");e.innerHTML="Loading logs...",$("#logsModal").modal("show");_entity.callAPI("../aspx/Entity.aspx/GetARMLogsWS",{},!0,function(t){if(t.success)try{var n=JSON.parse(JSON.parse(t.response).d);e.innerHTML=createARMLogsTable(n)}catch(a){e.innerHTML="No Logs available"}})}function createARMLogsTable(e){var t=document.createElement("table");t.className="table table-striped table-bordered";var n=document.createElement("tbody");return e.forEach(function(e){var t=document.createElement("tr"),a=document.createElement("td");a.innerText=e,t.appendChild(a),n.appendChild(t)}),t.appendChild(n),t.outerHTML}function debounce(e,t){var n;return function(){for(var a=this,i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];clearTimeout(n),n=setTimeout(function(){e.apply(a,o)},t)}}var searchInput=document.getElementById("searchBox"),liveSearchDebounced=debounce(liveSearch,500);function handleSearchInput(){""===searchInput.value?liveSearch():liveSearchDebounced()}function liveSearch(){var e=document.querySelectorAll("#body_Container .Project_items"),t=document.querySelectorAll("#table-body_Container tbody tr"),n=searchInput.value.toLowerCase();_entity.tableViewFlag?(t.forEach(function(e){e.innerText.toLowerCase().includes(n)?e.classList.remove("d-none"):e.classList.add("d-none")}),0==document.querySelectorAll("#table-body_Container tbody tr:not(.d-none)").length&&showAlertDialog("warning","No matching data found")):(e.forEach(function(e){e.innerText.toLowerCase().includes(n)?e.classList.remove("d-none"):e.classList.add("d-none")}),0==document.querySelectorAll("#body_Container .Project_items:not(.d-none)").length&&showAlertDialog("warning","No matching data found"))}searchInput.addEventListener("keyup",handleSearchInput),searchInput.addEventListener("input",handleSearchInput),document.getElementById("searchBox").addEventListener("keypress",function(e){"Enter"===e.key&&e.preventDefault()});var isCardView=!1;function toggleView(){var e=arguments.length>0&&arguments[0]!==undefined&&arguments[0],t=arguments.length>1?arguments[1]:undefined;if(pageNo=1,_entity.viewMode=t,isCardView=!("table"==_entity.viewMode),e){var n={page:"Entity",transId:_entity.entityTransId,properties:{TABLEVIEW:!isCardView},confirmNeeded:!0,storeData:e,allUsers:!1};_entityCommon.setAnalyticsDataWS(n,successCB=function(){window.location.reload()},errorCB=function(e){showAlertDialog("error",e.status+" "+e.statusText)})}else if(isCardView)$("#table-body_Container").hide(),$("#body_Container").show(),createCardViewHTML(),$("#viewIcon").text("view_module");else if($("#body_Container").hide(),$("#table-body_Container").show(),_entity.listJson.length>0){$("#table-body_Container").html(createTableViewHTML(_entity.listJson));var a=document.querySelector(".table-responsive");a.removeEventListener("scroll",scrollListener),a.addEventListener("scroll",scrollListener),$("#viewIcon").text("view_list")}else{_entity.listJson=[],document.querySelector("#table-body_Container").innerHTML=_entity.emptyRowsHtml,$("#viewIcon").text("view_module");var i=document.createElement("div");i.classList.add("no-records-message"),i.textContent="No more records",$("#table-body_Container").append(i),setTimeout(function(){$(i).remove()},3e3)}}function reloadEntityPage(){window.location.reload()}function onToggleViewButtonClick(e){toggleView(!0,e)}function formatFieldName(e){return e.replace(/([A-Z])/g," $1").replace(/createdby/g,"Created By").replace(/modifiedby/g,"Modified By").replace(/createdon/g,"Created On").replace(/modifiedon/g,"Modified On").replace(/^ /,"")}function createTableViewHTML(e,t){var n=$("#table-body_Container"),a=n.find("table").length>0,i=_entity.keyField||"",o="",s=new Set(["transid","ftransid"]),r=!e.some(function(e){return e[i]}),l=_entity.metaData.filter(function(e){return"T"===e.listingfld}),c=new Set,d=new Set;if("string"==typeof _entity.modificationFields){var u=_entity.modificationFields.split(",");u.length>0&&["modifiedby","modifiedon","createdby","createdon"].forEach(function(e){if(u.includes(e)){var t={fldname:e,fldcap:formatFieldName(e),listingfld:"T"};l.push(t)}})}for(var m in e[0])s.has(m)||c.add(m);if(!i||!_entity.metaData.some(function(e){return e.fldname.toLowerCase()===i.toLowerCase()})){var p=getKeyField();i=p?p.fldname:_entity.keyField}if(a)n.find("tbody").empty();else{var h;if(o+='<div class="table-responsive"><table class="table table-striped">',o+='<thead class="sticky-header"><tr>',o+='<th><input type="checkbox" id="selectAllCheckbox" onclick="toggleSelectAll(this)"></th>',o+="<th></th>",c.has(null===(h=i)||void 0===h?void 0:h.toLowerCase())){var f=_entity.metaData.find(function(e){return e.fldname.toLowerCase()===i.toLowerCase()});f&&(o+="<th>".concat(f.fldcap,"</th>"))}else o+="<th>--</th>";l.forEach(function(e){e.fldname.toLowerCase()===i.toLowerCase()||!c.has(e.fldname.toLowerCase())||s.has(e.fldname)||r&&"transid"===e.fldname.toLowerCase()||d.has(e.fldname)||(o+="<th>".concat(e.fldcap,"</th>"),d.add(e.fldname))}),o+="</tr></thead><tbody>"}if(_entity.navigationRecords=[],e.forEach(function(e,t){o+="<tr>",o+='<td><input type="checkbox" class="rowCheckbox" data-index="'.concat(t,'" data-recordid="').concat(e.recordid,'"></td>'),o+='<td><button type="button" class="btn btn-icon btn-white btn-color-gray-600 btn-active-primary shadow-sm tb-btn btn-sm me-3" data-bs-toggle="tooltip" title="Edit" data-bs-original-title="Edit" onclick="return _entity.editEntity(\''.concat(e.recordid,"','").concat(e.rno,'\')"><span class="material-icons material-icons-style material-icons-2" style="color: red;">edit_note</span></button></td>');var n=_entity.entityName,a=_entity.entityTransId,d=e.recordid;_entity.navigationRecords.push(d);var u=e.rno;if(c.has(i.toLowerCase())){var m,p,h=null!==(m=null===(p=e[i.toLowerCase()])||void 0===p?void 0:p.toString())&&void 0!==m?m:"",f=l.find(function(e){return e.fldname.toLowerCase()==i.toLowerCase()});"d"!==f.fdatatype&&"Date"!==f.cdatatype||(h=formatDateString(h)),o+='<td><a href="#" onclick="_entity.openEntityForm(\''.concat(n,"','").concat(a,"', '").concat(d,"', '").concat(h.replace(/\\/g,"\\\\"),"', ").concat(u,')">').concat(_entityCommon.inValid(h)?"--":h.replace(/\\/g,"\\\\"),"</a></td>")}else o+='<td><a href="#" onclick="_entity.openEntityForm(\''.concat(n,"','").concat(a,"', '").concat(d,"', '', ").concat(u,')">--</a></td>');l.forEach(function(t){if(t.fldname.toLowerCase()!==i.toLowerCase()&&c.has(t.fldname.toLowerCase())&&!s.has(t.fldname)&&(!r||"transid"!==t.fldname.toLowerCase())){var n=e[t.fldname.toLowerCase()],a="";a="Check box"===t.cdatatype||"Check box"===t.fdatatype?'\n                        <div class="form-check">\n                            <input class="form-check-input" type="checkbox" '.concat("T"===n?"checked":""," disabled>\n                        </div>"):"modifiedon"!==t.fldname.toLowerCase()&&"createdon"!==t.fldname.toLowerCase()&&"d"!==t.fdatatype&&"Date"!==t.cdatatype||!n?"Currency"===t.cdatatype||"Currency"===t.fdatatype?formatNumberBasedOnMillions(n):"".concat(n||""):formatDateString(n),o+="<td>".concat(a,"</td>")}}),o+="</tr>"}),a){var y=$("#table-body_Container .table").DataTable();$.fn.DataTable.isDataTable("#table-body_Container .table")&&(y.destroy(),n.find("tbody").empty()),n.find("tbody").append(o),initializeDataTable()}else o+="</tbody></table></div>",n.append(o),initializeDataTable()}function capitalizeFirstLetter(e){return e.charAt(0).toUpperCase()+e.slice(1)}function initializeDataTable(){$.fn.DataTable.isDataTable("#table-body_Container .table")&&$("#table-body_Container .table").DataTable().destroy(),table=$("#table-body_Container .table").DataTable({bInfo:!1,dom:"Bfrtip",paging:!1,searching:!1,ordering:!0,columnDefs:[{targets:0,orderable:!1}]}),$("#floatingMenu-export a").on("click",function(e){e.preventDefault();var t=$(this).data("target"),n=table.buttons(".buttons-".concat(t.toLowerCase()));n&&n.trigger()})}function handleExport(e,t){var n=_entity.entityName,a="en-us"===dtCulture?"MM/dd/yyyy":"dd/MM/yyyy";var i=_entity.listJson.length,o=_entity.entityTransId,s=function(e){switch(e.toUpperCase()){case"PDF":return"pdf";case"EXCEL":return"xlsx";case"PRINT":return"pdf";case"WORD":return"docx";default:return"pdf"}}(e),r="".concat(n,".").concat(s),l=n;if("WORD"===e.toUpperCase()||i>_entity.pageSize*_entity.maxPageNumber-1)ASB.WebService.ARMExportPushToQueue(o,"list",r,"Entity",a,_entity.fields,_entity.entityName,function(e){e.startsWith("RMQError:")?showAlertDialog("error",e.replace("RMQError:","")):$("#exportModal").modal("show")},function(e){console.error("Export request failed: ",e)});else{$.fn.dataTable.isDataTable("#hiddenTable")&&$("#hiddenTable").DataTable().destroy(),createHiddenTableFromMetadata(),function(e,t){if(e.buttons)switch(t.toUpperCase()){case"PRINT":e.button(".buttons-print").trigger();break;case"PDF":e.button(".buttons-pdf").trigger();break;case"EXCEL":e.button(".buttons-excel").trigger();break;default:console.error("Unsupported export action: "+t)}else console.error("Buttons are not initialized for the table")}($("#hiddenTable").DataTable({dom:"Bfrtip",buttons:[{extend:"copy",text:"Copy",filename:l},{extend:"csv",text:"CSV",filename:"".concat(l)},{extend:"excel",text:"Excel",filename:"".concat(l)},{extend:"pdf",text:"PDF",filename:"".concat(l)},{extend:"print",text:"Print",filename:"".concat(l)}]}),e)}}function createHiddenTableFromMetadata(){$("#hiddenTableContainer").empty();var e='<table id="hiddenTable" class="display nowrap" style="width:100%">\n        <thead><tr>',t=[];_entity.metaData.forEach(function(n){"T"!==n.hide&&(t.push(n),e+="<th>".concat(n.fldcap,"</th>"))}),e+="</tr></thead><tbody>",_entity.listJson.forEach(function(n){var a=!1,i="<tr>";t.forEach(function(e){var t=n[e.fldname.toLowerCase()]||"";if(""!==t){if(a=!0,isDateField(e)){var o=new Date(t);if(!isNaN(o))if("modifiedon"===e.fldname.toLowerCase()){var s=o.toLocaleDateString("en-GB",{day:"2-digit",month:"2-digit",year:"numeric"}),r=o.toLocaleTimeString("en-GB",{hour:"2-digit",minute:"2-digit",second:"2-digit"});t="".concat(s," ").concat(r)}else t=o.toLocaleDateString("en-GB",{day:"2-digit",month:"2-digit",year:"numeric"})}else t=t.replace(/Z$/,"");i+="<td>".concat(t,"</td>")}else i+="<td></td>"}),i+="</tr>",a&&(e+=i)}),e+="</tbody></table>",$("#hiddenTableContainer").append(e)}function isDateField(e){return"Date"===e.cdatatype||"d"===e.fdatatype||"modifiedon"===e.fldname.toLowerCase()}function toggleSelectAll(e){var t=document.querySelectorAll(".rowCheckbox");t.forEach(function(t){t.checked=e.checked});var n=Array.from(t).filter(function(e){return e.checked}).length;console.log("Selected rows: ".concat(n))}function showNotification(e){document.querySelector("#notificationModal .modal-body").textContent=e,new bootstrap.Modal(document.getElementById("notificationModal")).show()}function deleteSelectedRecordsFromToolbar(){var e=document.querySelectorAll(".rowCheckbox:checked"),t=document.querySelectorAll(".Select-Project:checked"),n=[].concat(_toConsumableArray(e),_toConsumableArray(t));if(0!==n.length){var a=[],i="";n.forEach(function(e,t){var n=e.getAttribute("data-recordid");a.push(n),i+="\n            <row>\n                <rowno>".concat(t+1,"</rowno>\n                <recordid>").concat(n,"</recordid>\n            </row>")});var o="Are you sure you want to delete ".concat(a.length," record(s)?");confirm(o)&&performDeletion(a,i)}else showNotification("Please select at least one record to delete.")}function performDeletion(e,t){var n=window.top.axTraceFlag?"DeleteRow-".concat(_entity.entityTransId,""):"",a={recIds:e.join(","),transid:_entity.entityTransId,s:'<root axpapp="'.concat(window.top.mainProject,'" trace="').concat(n,'" sessionid="').concat(window.top.mainSessionId,'" stype="iviews" sname="').concat(_entity.entityTransId,'" actname="delete">\n            <varlist>').concat(t,"</varlist>\n        ")};ASB.WebService.DeleteIviewRow(a.recIds,a.transid,a.s,function(t){if(t){var n,a;if((t=JSON.parse(t)).error)return void showAlertDialog("error",null===(n=t.error)||void 0===n?void 0:null===(a=n[0])||void 0===a?void 0:a.msg);showNotification("".concat(e.length," record(s) deleted successfully.")),_entity.reloadEntityPage()}else showNotification("Failed to delete records. Please try again.")},function(e){console.error("Error details:",e),showNotification("Error while deleting records. Please try again.")})}function createCardViewHTML(){createListHTML(_entity.listJson,1)}function scrollListener(e){var t=e.target,n=t.scrollTop,a=t.scrollLeft;this.lastScrollTop!==n&&(this.lastScrollTop=n,!isFetching&&isScrollAtBottomWithinDiv(t)&&(isFetching=!0,pageNo++,_entity.getEntityListData(pageNo),setTimeout(function(){isFetching=!1},500))),this.lastScrollLeft=a}function handleNoChartData(){document.querySelectorAll(".analytics-container, .entity-card").forEach(function(e){e.classList.add("d-none")}),document.querySelectorAll(".nodata, .NO-KPI-Items").forEach(function(e){e.classList.remove("d-none")})}function handleValidChartData(){document.querySelectorAll(".analytics-container, .entity-card").forEach(function(e){e.classList.remove("d-none")}),document.querySelectorAll(".nodata, .NO-KPI-Items").forEach(function(e){e.classList.add("d-none")})}function selectView(e){_entity.tableViewFlag="table"===e;var t=document.getElementById("tableView"),n=document.getElementById("listView");_entity.tableViewFlag?(t.classList.add("selected"),n.classList.remove("selected")):(n.classList.add("selected"),t.classList.remove("selected"))}function selectCaptions(e){_entity.captionsEnabled="visible"===e;var t=document.getElementById("visible"),n=document.getElementById("hidden");_entity.captionsEnabled?(t.classList.add("selected"),n.classList.remove("selected")):(n.classList.add("selected"),t.classList.remove("selected"))}function highlightInitialSelection(){_entity.tableViewFlag?selectView("table"):selectView("list"),_entity.captionsEnabled?selectCaptions("visible"):selectCaptions("hidden")}function toggleRightPanel(e,t){if(t){var n={page:"Entity",transId:_entity.entityTransId,properties:{RIGHTPANEL:"expand"===e?"expanded":"collapsed"},confirmNeeded:!0,allUsers:!1};_entityCommon.setAnalyticsDataWS(n,function(){toggleRightPanelUI(e),rowsCountHelper.init()},function(e){showAlertDialog("error",e.status+" "+e.statusText)})}else toggleRightPanelUI(e)}function toggleRightPanelUI(e){var t=document.getElementById("Entity_management_Right"),n=document.getElementById("btn-expandright"),a=document.getElementById("btn-collapseright");if("expand"===e){if($(t).removeClass("d-none"),$(n).addClass("d-none"),$(a).removeClass("d-none"),_entity.properties.RIGHTPANEL="expanded",_entity.initCharts(),callParentNew("isMobile")){var i=document.getElementById("Entity_management_Left");i&&i.classList.remove("vh-100","min-vh-100")}}else $(t).addClass("d-none"),$(n).removeClass("d-none"),$(a).addClass("d-none"),_entity.properties.RIGHTPANEL="collapsed"}function showRightPanel(){}function formatNumberBasedOnMillions(e){return 0!==Object.values(window.top.allGloblVars.globalVars).map(function(e){return e}).filter(function(e){return e.millions}).length&&"T"===Object.values(window.top.allGloblVars.globalVars).map(function(e){return e}).filter(function(e){return e.millions})[0].millions||!1?InsertCommas(e):formatIndianNumber(e)}function InsertCommas(e){var t=parseFloat(e);isNaN(t)&&(t=0);var n="";return t<0&&(n="-"),t=Math.abs(t),t=parseInt(100*(t+.005)),t/=100,s=new String(t),s.indexOf(".")<0&&(s+=".00"),s.indexOf(".")===s.length-2&&(s+="0"),s=n+s,CommaFormatted(s)}function CommaFormatted(e){var t="";-1===e.toString().indexOf(".")&&(e+=".");var n="";(t=e.split(".")).length>1&&(n=t[1].toString());var a=parseInt(t[0]);if(isNaN(a))return"";var i="";e<0&&(i="-"),a=Math.abs(a);var o=new String(a);t=[];try{if(Parameters.length>0&&Parameters.indexOf("millions~T")>-1)for(;o.length>3;){var s=o.substr(o.length-3);t.unshift(s),o=o.substr(0,o.length-3)}else{if(o.length>3){s=o.substr(o.length-3);t.unshift(s),o=o.substr(0,o.length-3)}for(;o.length>2;){s=o.substr(o.length-2);t.unshift(s),o=o.substr(0,o.length-2)}}}catch(r){for(;o.length>3;){s=o.substr(o.length-3);t.unshift(s),o=o.substr(0,o.length-3)}}return o.length>0&&t.unshift(o),o=t.join(","),e=i+(e=n.length<1?o:o+"."+n)}function formatIndianNumber(e){if(isNaN(e))return"";var t=Math.abs(parseInt(e,10)).toString(),n="";for(t.length>3&&(n=","+t.slice(-3),t=t.slice(0,-3));t.length>2;)n=","+t.slice(-2)+n,t=t.slice(0,-2);return t.length>0&&(n=t+n),(e<0?"-":"")+n}function ShowHideDimmer(e){try{"undefined"!=typeof parent.ShowDimmer&&parent.ShowDimmer(e),"undefined"!=typeof ShowDimmer&&ShowDimmer(e),"undefined"!=typeof window.top.ShowDimmer&&window.top.ShowDimmer(e)}catch(t){}}function setDataListDictionary(e){ASB.WebService.SetListViewDictionary(_entity.navigationRecords,e,_entity.entityTransId,function(e,t){},function(e){})}$(document).ready(function(){$(".entity-card").on("click",function(){var e=$("#Homepage_CardsList_Wrapper"),t=$(this).find(".arrow-icon");e.hasClass("show")?e.removeClass("show").slideUp():e.addClass("show").slideDown(),t.toggleClass("fa-chevron-down fa-chevron-up")})});var RowsCountHelper=function(){function e(){_classCallCheck(this,e),this.totalRecords=null,this.rowCountElement=null,this.rowsCountIconElement=null,this.loadAllRowsIconElement=null,this.containerElement=null,this.userClickedQuestionMark=!1}return _createClass(e,[{key:"init",value:function(){var e=this,t=document.querySelector(".global-rowcount-container");t&&t.remove(),!this.totalFetched&&_entity.listJson.length<_entity.pageSize*_entity.maxPageNumber-1&&(this.totalRecords=_entity.listJson.length);var n,a="undefined"!=typeof this.totalRecords&&this.totalRecords>0;(_entity.allRecordsLoaded&&(a=!0,this.totalRecords=_entity.listJson.length),this.containerElement=document.createElement("div"),this.containerElement.className="global-rowcount-container",this.containerElement.style.cssText="display: flex; align-items: center; gap: 8px; padding: 4px 12px; ",this.rowCountElement=document.createElement("span"),this.rowCountElement.id="global-rowcount-text",this.rowCountElement.style.cssText="font-weight: 600; white-space: nowrap;",a?(this.rowCountElement.textContent="Rows: 1-".concat(_entity.listJson.length," of ").concat(this.totalRecords),this.showQuestionMark(!1)):(this.rowCountElement.textContent="Rows: 1-".concat(_entity.pageSize*_entity.maxPageNumber," of"),this.rowsCountIconElement=document.createElement("span"),this.rowsCountIconElement.id="global-rowcount-icon",this.rowsCountIconElement.className="material-icons material-icons-style material-icons-3",this.rowsCountIconElement.style.cssText="cursor: pointer; font-weight: 600; color: #666; display: inline-block; vertical-align: middle; font-size: 16px;",this.rowsCountIconElement.textContent="question_mark",this.rowsCountIconElement.title="Click to view total records",this.rowsCountIconElement.addEventListener("click",function(t){return t.preventDefault(),t.stopImmediatePropagation(),e.handleTotalCountClick(),!1}),this.showQuestionMark(!0)),_entity.allRecordsLoaded?this.showLoadAllRecords(!1):(this.loadAllRowsIconElement=document.createElement("span"),this.loadAllRowsIconElement.id="global-rowcount-icon",this.loadAllRowsIconElement.className="material-icons material-icons-style material-icons-3",this.loadAllRowsIconElement.style.cssText="cursor: pointer; font-weight: 600; color: #666; display: inline-block; vertical-align: middle; font-size: 16px;",this.loadAllRowsIconElement.textContent="play_for_work",this.loadAllRowsIconElement.title="Show all records",this.loadAllRowsIconElement.addEventListener("click",function(t){return t.preventDefault(),t.stopImmediatePropagation(),e.handleFetchAllRowsClick(),!1}),this.showLoadAllRecords(!0)),this.containerElement.appendChild(this.rowCountElement),this.rowsCountIconElement&&this.containerElement.appendChild(this.rowsCountIconElement),this.loadAllRowsIconElement&&this.containerElement.appendChild(this.loadAllRowsIconElement),this.containerElement)&&(this.containerElement.parentNode&&this.containerElement.parentNode.removeChild(this.containerElement),(n="expanded"==_entity.properties.RIGHTPANEL?document.querySelector("#Entity_management_Right .card-toolbar"):document.querySelector("#Entity_management_Left .card-toolbar"))&&void 0!==n&&_entity.listJson.length>0&&n.appendChild(this.containerElement))}},{key:"setTotalRecords",value:function(e){this.totalRecords=e,this.totalFetched=!0,this.init()}},{key:"showQuestionMark",value:function(e){this.rowsCountIconElement&&(e?(this.rowsCountIconElement.className="material-icons material-icons-style material-icons-3",this.rowsCountIconElement.style.cssText="cursor: pointer; font-weight: 600; color: #666; display: inline-block; vertical-align: middle; font-size: 16px;",this.rowsCountIconElement.textContent="question_mark",this.rowsCountIconElement.title="Click to view total records"):this.rowsCountIconElement.style.cssText="display: none;")}},{key:"showLoadAllRecords",value:function(e){this.loadAllRowsIconElement&&(e?(this.loadAllRowsIconElement.className="material-icons material-icons-style material-icons-3",this.loadAllRowsIconElement.style.cssText="cursor: pointer; font-weight: 600; color: #666; display: inline-block; vertical-align: middle; font-size: 16px;",this.loadAllRowsIconElement.textContent="play_for_work",this.loadAllRowsIconElement.title="Show all records"):this.loadAllRowsIconElement.style.cssText="display: none;")}},{key:"handleTotalCountClick",value:function(){this.userClickedQuestionMark||(this.userClickedQuestionMark=!0,this.rowsCountIconElement.textContent="",this.rowsCountIconElement.style.cursor="wait",this.fetchTotalCount())}},{key:"handleFetchAllRowsClick",value:function(){_entity.allRecordsLoaded||(this.loadAllRowsIconElement.textContent="",this.loadAllRowsIconElement.style.cursor="wait",this.loadAllRecords())}},{key:"fetchTotalCount",value:function(){var e=this;if(!this.totalFetched){var t={aggField:"count",aggFunc:"count",aggTransId:_entity.entityTransId,groupField:"all",groupTransId:_entity.entityTransId,page:"Entity",transId:_entity.entityTransId},n=top.window.location.href.toLowerCase().substring(0,top.window.location.href.toLowerCase().indexOf("/aspx/"))+"/aspx/Analytics.aspx/GetAnalyticsChartsDataWS";$.ajax({url:n,type:"POST",dataType:"json",contentType:"application/json",data:JSON.stringify(t),success:function(t){try{var n=JSON.parse(t.d),a=JSON.parse(n.result.charts[0].data_json),i=a&&a[0]?a[0].totrec:0;e.setTotalRecords(i)}catch(o){console.error("fetchTotalCount: parse total error",o),e.setTotalRecords(null)}},error:function(t){console.error("fetchTotalCount: fetch total error",t),e.setTotalRecords(null)}})}}},{key:"loadAllRecords",value:function(){_entity.pageSize=0,_entity.getEntityListData(1)}}]),e}();