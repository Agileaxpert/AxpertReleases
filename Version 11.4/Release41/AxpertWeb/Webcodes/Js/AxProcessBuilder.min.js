/*https://web.agile-labs.com/minZIP/*//*version=3.9.1*/function _slicedToArray(e,s){return _arrayWithHoles(e)||_iterableToArrayLimit(e,s)||_unsupportedIterableToArray(e,s)||_nonIterableRest()}function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function _unsupportedIterableToArray(e,s){if(e){if("string"==typeof e)return _arrayLikeToArray(e,s);var t=Object.prototype.toString.call(e).slice(8,-1);return"Object"===t&&e.constructor&&(t=e.constructor.name),"Map"===t||"Set"===t?Array.from(e):"Arguments"===t||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t)?_arrayLikeToArray(e,s):void 0}}function _arrayLikeToArray(e,s){(null==s||s>e.length)&&(s=e.length);for(var t=0,a=new Array(s);t<s;t++)a[t]=e[t];return a}function _iterableToArrayLimit(e,s){var t=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=t){var a,r,o=[],n=!0,i=!1;try{for(t=t.call(e);!(n=(a=t.next()).done)&&(o.push(a.value),!s||o.length!==s);n=!0);}catch(c){i=!0,r=c}finally{try{n||null==t["return"]||t["return"]()}finally{if(i)throw r}}return o}}function _arrayWithHoles(e){if(Array.isArray(e))return e}function _classCallCheck(e,s){if(!(e instanceof s))throw new TypeError("Cannot call a class as a function")}function _defineProperties(e,s){for(var t=0;t<s.length;t++){var a=s[t];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}function _createClass(e,s,t){return s&&_defineProperties(e.prototype,s),t&&_defineProperties(e,t),Object.defineProperty(e,"prototype",{writable:!1}),e}var axProcessBuilderObj,AxProcessBuilder=function(){function e(){_classCallCheck(this,e),this.processName="",this.keyField="",this.keyValue="",this.stepHtml='\n            <div class="step">\n                <div>\n                    <div class="circle ">\n                        <i class="fa fa-check"></i>\n                        <span class="Emp-steps-counts">{{sno}}</span>\n                    </div>\n                    <div class="line"></div>\n                </div>\n                <div class="Task-process-wrapper">\n                    {{groupNameHtml}}\n                    {{taskCaptionHtml}}\n                </div>\n            </div>',this.groupNameHtml='\n            <div class="title">\n                <a href="javascript:void(0)">{{taskgroup}}</a>\n <span data-groupname="{{taskgroup}}" class="Process-flow accordion-icon rotate">\n                    <span  class="material-icons material-icons-style material-icons-2">chevron_right</span>\n                    \n                </span>\n            </div>',this.taskCaptionHtml='<div class="process-sub-flow" data-groupname="{{taskgroup}}" data-tasktype="{{tasktype}}">',this.taskCaptionHtml+='<div class="positionRel Task-process-list">',this.taskCaptionHtml+="<a href=\"javascript:void(0)\" onclick=\"axProcessBuilderObj.openTask(this, '{{tasktype}}', '{{recordid}}');\">{{taskname}}</a>",this.taskCaptionHtml+='<div class="plusactioncontainer">',this.taskCaptionHtml+='<div class="addTopBtnlink" ><span class="material-icons material-icons-style material-icons-2 addTopBtn">add</span>',this.taskCaptionHtml+='<div class="addProcessHilight">',this.taskCaptionHtml+="<a href=\"javascript:void(0)\" class=\"make\" onclick=\"axProcessBuilderObj.openNewTask('Make','{{indexno}}', '{{processname}}','{{taskgroup}}'); return false;\">Make</a><a href=\"javascript:void(0)\" class=\"approve\"  onclick=\"axProcessBuilderObj.openNewTask('Approve','{{indexno}}', '{{processname}}','{{taskgroup}}'); return false;\">Approve<a><a href=\"javascript:void(0)\" class=\"check\" onclick=\"axProcessBuilderObj.openNewTask('Check','{{indexno}}', '{{processname}}','{{taskgroup}}'); return false;\">Check</a>",this.taskCaptionHtml+="<a href=\"javascript:void(0)\" class=\"if\" onclick=\"axProcessBuilderObj.openNewTask('If','{{indexno}}', '{{processname}}','{{taskgroup}}'); return false;\">If</a><a href=\"javascript:void(0)\" class=\"else\" onclick=\"axProcessBuilderObj.openNewTask('Else','{{indexno}}', '{{processname}}','{{taskgroup}}'); return false;\">Else</a><a href=\"javascript:void(0)\" class=\"IfElse\" onclick=\"axProcessBuilderObj.openNewTask('Else if','{{indexno}}', '{{processname}}','{{taskgroup}}'); return false;\">Else if</a><a href=\"javascript:void(0)\" class=\"end\" onclick=\"axProcessBuilderObj.openNewTask('End','{{indexno}}', '{{processname}}','{{taskgroup}}'); return false;\">End</a>",this.taskCaptionHtml+="</div></div>",this.taskCaptionHtml+='<div class="addTopBtnHLine">&nbsp;</div>',this.taskCaptionHtml+='<div class="addTopBtnVLine">&nbsp;</div>',this.taskCaptionHtml+='<div class="addBotBtnlink"><span class="material-icons material-icons-style material-icons-2 addBotBtn">add</span>',this.taskCaptionHtml+='<div class="addSubProcessHilight">',this.taskCaptionHtml+="<a href=\"javascript:void(0)\" class=\"make\" onclick=\"axProcessBuilderObj.openNewTask('Make','{{nextindexno}}', '{{processname}}','{{taskgroup}}'); return false;\">Make</a><a href=\"javascript:void(0)\" class=\"approve\"  onclick=\"axProcessBuilderObj.openNewTask('Approve','{{nextindexno}}', '{{processname}}','{{taskgroup}}'); return false;\">Approve<a><a href=\"javascript:void(0)\" class=\"check\" onclick=\"axProcessBuilderObj.openNewTask('Check','{{nextindexno}}', '{{processname}}','{{taskgroup}}'); return false;\">Check</a>",this.taskCaptionHtml+="<a href=\"javascript:void(0)\" class=\"if\" onclick=\"axProcessBuilderObj.openNewTask('If','{{nextindexno}}', '{{processname}}','{{taskgroup}}'); return false;\">If</a><a href=\"javascript:void(0)\" class=\"else\" onclick=\"axProcessBuilderObj.openNewTask('Else','{{nextindexno}}', '{{processname}}','{{taskgroup}}'); return false;\">Else</a><a href=\"javascript:void(0)\" class=\"IfElse\" onclick=\"axProcessBuilderObj.openNewTask('Else if','{{nextindexno}}', '{{processname}}','{{taskgroup}}'); return false;\">Else if</a><a href=\"javascript:void(0)\" class=\"end\" onclick=\"axProcessBuilderObj.openNewTask('End','{{nextindexno}}', '{{processname}}','{{taskgroup}}'); return false;\">End</a>",this.taskCaptionHtml+="</div></div></div></div>",this.taskCaptionHtml+="</div>",this.dataSources=[],this.processFlowObj={},this.getUrlParams()}return _createClass(e,[{key:"fetchProcessDefinition",value:function(e){var s=this,t={processName:this.processName};this.callAPI("../aspx/AxPEG.aspx/AxGetProcessDefinition",t,!0,function(t){if(t.success){var a=JSON.parse(t.response);if(a.d.startsWith("<!DOCTYPE HTML PUBLIC "))return void showAlertDialog("error",appGlobalVarsObject.lcm[572]);var r=s.dataConvert(a,"ARM");s.dataSources[e]=r,s.showProcessDefinition()}})}},{key:"callAPI",value:function(e,s,t,a){var r=this,o=new XMLHttpRequest;o.open("POST",e,t),o.setRequestHeader("Content-Type","application/json;charset=UTF-8"),o.onreadystatechange=function(){4==this.readyState&&(200==this.status?a({success:!0,response:this.responseText}):(r.catchError(this.responseText),a({success:!1,response:this.responseText})))},o.send(JSON.stringify(s))}},{key:"catchError",value:function(e){showAlertDialog("error",e)}},{key:"showSuccess",value:function(e){showAlertDialog("success",e)}},{key:"isEmpty",value:function(e){return""==e}},{key:"isUndefined",value:function(e){return void 0===e}},{key:"dataConvert",value:function(e,s){if("AXPERT"==s){try{if("undefined"!=typeof(e=JSON.parse(e.d)).result[0].result.row)return e.result[0].result.row}catch(t){this.catchError(t.message)}try{if("undefined"!=typeof e.result[0].result)return e.result[0].result}catch(t){this.catchError(t.message)}}else if("ARM"==s)try{if((e=JSON.parse(e.d)).result.success){if(!this.isUndefined(e.result.data))return e.result.data}else this.isUndefined(e.result.message)||this.catchError(e.result.message)}catch(t){this.catchError(t.message)}return e}},{key:"generateFldId",value:function(){return"fid".concat(Date.now()).concat(Math.floor(9e4*Math.random())+1e4)}},{key:"isNull",value:function(e){return null==e}},{key:"isNullOrEmpty",value:function(e){return null==e||""==e}},{key:"showProcessDefinition",value:function(){var e=this;this.processFlowObj={},this.dataSources.Process.forEach(function(s,t){e.isUndefined(e.processFlowObj[s.taskgroup])&&(e.processFlowObj[s.taskgroup]={},e.processFlowObj[s.taskgroup].group_name_html="",e.processFlowObj[s.taskgroup].task_caption_html=""),e.isNullOrEmpty(s.taskstatus)&&s.indexno>1&&(s.taskstatus="disabled"),e.isNullOrEmpty(s.recordid)&&(s.recordid="0");var a=e.processFlowObj[s.taskgroup];a.indexno=s.indexno,a.group_name_html=Handlebars.compile(e.groupNameHtml)(s),a.task_caption_html+=Handlebars.compile(e.taskCaptionHtml)(s)}),document.querySelector("#procflow-steps").innerHTML="";for(var s=1,t=0,a=Object.entries(this.processFlowObj);t<a.length;t++){var r=_slicedToArray(a[t],2),o=(r[0],r[1]);document.querySelector("#procflow-steps").insertAdjacentHTML("beforeend"," ".concat(this.stepHtml.replace("{{sno}}",s).replace("{{groupNameHtml}}",o.group_name_html).replace("{{taskCaptionHtml}}",o.task_caption_html)," ")),s++}ShowDimmer(!1),0==document.querySelectorAll(".Task-process-list").length?(this.openNewTask("Make","1",this.processName,""),document.querySelector("#PROFLOW-profile-container arrows").classList.toggle("d-none"),document.querySelector("#NoRecords").classList.toggle("d-none")):document.querySelector(".Task-process-list a").click(),$(".accordion-icon").click(function(){var e=$(this).attr("data-groupname");$(this).toggleClass("rotate"),$('.process-sub-flow[data-groupname="'.concat(e,'"]')).toggle()})}},{key:"openTask",value:function(e,s,t){var a=document.querySelectorAll(".Task-process-list.Active");[].forEach.call(a,function(e){e.classList.remove("Active")}),null==e||e.closest(".Task-process-list").classList.add("Active");var r=document.querySelectorAll(".step.step-active");[].forEach.call(r,function(e){e.classList.remove("step-active")}),null==e||e.closest(".step").classList.add("step-active");var o="";"MAKE"==(s=s.toUpperCase())?o="pgv2m":"APPROVE"==s||"CHECK"==s?o="pgv2a":"IF"!=s&&"ELSE"!=s&&"ELSE IF"!=s&&"END"!=s||(o="pgv2c"),this.loadTstruct(o,t)}},{key:"openNewTask",value:function(e,s,t,a){var r="",o=e.toUpperCase();"MAKE"==o?r="pgv2m":"APPROVE"==o||"CHECK"==o?r="pgv2a":"IF"!=o&&"ELSE"!=o&&"ELSE IF"!=o&&"END"!=o||(r="pgv2c"),this.openTstruct(r,"&processname=".concat(t,"&indexNo=").concat(s,"&taskType=").concat(e,"&taskgroupname=").concat(a))}},{key:"openTstruct",value:function(e,s){var t="../aspx/tstruct.aspx?transid=".concat(e,"&act=open&recordid=0").concat(s),a=document.querySelector("#rightIframe");a.setAttribute("src",""),a.setAttribute("src",t)}},{key:"loadTstruct",value:function(e,s){var t="../aspx/tstruct.aspx?transid=".concat(e,"&act=load&recordid=").concat(s),a=document.querySelector("#rightIframe");a.setAttribute("src",""),a.setAttribute("src",t)}},{key:"getUrlParams",value:function(){var e=window.location.search,s=new URLSearchParams(e);this.keyField=s.get("keyfield"),this.keyValue=s.get("keyvalue")||"",this.processName=s.get("processname")||_processName,"new"==curMode?document.querySelector("#process-name").innerText="Enter Process Flow":document.querySelector("#process-name").innerText=this.processName}}]),e}();$(document).ready(function(){ShowDimmer(!0),(axProcessBuilderObj=new AxProcessBuilder).fetchProcessDefinition("Process")});