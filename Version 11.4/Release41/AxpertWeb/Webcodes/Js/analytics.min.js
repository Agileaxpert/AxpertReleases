/*https://web.agile-labs.com/minZIP/*//*version=3.9.1*/function _typeof(t){"@babel/helpers - typeof";return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function _defineProperties(t,e){for(var a=0;a<e.length;a++){var n=e[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function _createClass(t,e,a){return e&&_defineProperties(t.prototype,e),a&&_defineProperties(t,a),Object.defineProperty(t,"prototype",{writable:!1}),t}var dtCulture=eval(callParent("glCulture")),_entityFilter,_analyticsCharts,_entityCommon,_entityfilter,selectedItemsArray=[],AnalyticsCharts=function(){function t(){_classCallCheck(this,t),this.entityName="",this.entityTransId="",this.metaData={},this.listJson={},this.maxPageNumber=1,this.pageSize=50,this.kpiJson=[],this.chartsJson=[],this.chartsMetaData={},this.selectedCharts="",this.selectedChartsObj={},this.fldData={},this.emptyRowsHtml="No data found",this.filter="",this.xAxisFields="",this.yAxisFields="",this.selectedKeyField="",this.entityList=[],this.allEntitiesList=[],this.selectedEntitiesList=[],this.filterObj={},this.globalOrder=[],this.selectedChartType="pie",this.globalYOrder=[]}return _createClass(t,[{key:"init",value:function(){parent.ShowDimmer(!1);var t=document.querySelector("#hdnAnalyticsPageLoadData").value;if(t&&t.startsWith("<!DOCTYPE HTML PUBLIC "))showAlertDialog("error",appGlobalVarsObject.lcm[572]);else{var e=JSON.parse(t);if(_entityCommon.inValid(e.result.data.SelectedEntities))this.allEntitiesList=e.result.data.AllEntitiesList,this.constructEntityPopup(this.allEntitiesList),document.querySelector("#Entity_summary_Left").classList.add("d-none"),document.querySelector("#Entity_summary_Right").classList.add("d-none");else{var a=e.result.data.Properties,n=a.XAXISFIELDS,s=a.YAXISFIELDS;this.xAxisFields=n||"All",this.yAxisFields=s||"All",this.selectedChartType=e.result.data.Properties.CHARTTYPE||"pie",this.metaData=e.result.data.MetaData,this.selectedEntitiesList=e.result.data.SelectedEntitiesList,this.entityTransId=e.result.data.TransId,this.entityName=this.getEntityCaption(this.entityTransId),this.constructXandYAxis(this.metaData,"Page Load"),this.constructSelectedEntityHeader()}this.updateChartButton(this.selectedChartType)}}},{key:"updateChartButton",value:function(t){var e="",a="";switch(t){case"pie":e="Pie Chart",a="pie_chart";break;case"column":e="Column Chart",a="bar_chart";break;case"bar":e="Bar Chart",a="bar_chart";break;case"line":e="Line Chart",a="show_chart";break;default:e="Pie Chart",a="pie_chart"}var n=document.querySelector(".btn.dropdown-toggle");n&&(n.querySelector(".chart-name").textContent=e,n.querySelector(".material-icons").textContent=a)}},{key:"getAnalyticsChartsDataWS",value:function(t){var e=this;$.ajax({url:top.window.location.href.toLowerCase().substring(0,top.window.location.href.toLowerCase().indexOf("/aspx/"))+"/aspx/Analytics.aspx/GetAnalyticsChartsDataWS",type:"POST",cache:!1,async:!0,dataType:"json",data:JSON.stringify(t),contentType:"application/json",success:function(a){try{var n=JSON.parse(a.d);if(!n.result.success)return showAlertDialog("error",n.result.message),handleValidChartData(),document.querySelector("#KPI-2 .row").innerHTML="",document.querySelector("#Homepage_CardsList_Wrapper").innerHTML="",void(document.querySelector("#analytics-chart-title #chart-title").innerHTML="".concat(_analyticsCharts.entityName,"(s)"));var s=JSON.parse(n.result.charts[0].data_json);if(handleValidChartData(),document.querySelector("#Homepage_CardsList_Wrapper").innerHTML="","count"===t.aggField&&"all"===t.groupField){if(s.length>0){var i,r=s[0],o=_analyticsCharts.generateGeneralKPIHTML(r);document.querySelector("#KPI-2 .row").innerHTML=o,document.querySelector("#Homepage_CardsList_Wrapper").innerHTML="",document.querySelector("#analytics-chart-title #chart-title").innerHTML="".concat(_analyticsCharts.entityName,"(s)");var c={totrec:"Total records",cyear:"This year",cmonth:"This month",cweek:"This week",cyesterday:"Yesterday",ctoday:"Today"},l=Object.keys(r).filter(function(t){return"cnd"!=t&&"creiteria"!=t&&null!=t&&null!=r[t]&&0!=r[t]}).map(function(t){return{data_label:c[t],value:r[t]}}),d=[],u=e.selectedChartType||(null===(i=document.querySelector(".chart-selections a.bg-success"))||void 0===i?void 0:i.getAttribute("chart_type"));d.push({chartsid:"General",charttype:"chart",chartjson:JSON.stringify(l),chartname:"criteria",chart:u}),_analyticsCharts.chartsJson=d}}else if(s.length>0){var h,m,f=s,y=(d=[],f[0].criteria),p=y.split("~"),g="Empty data";if(""==p[1])g=(null===(m=e.filterByFldname(e.metaData,p[2])[0])||void 0===m?void 0:m.fldcap)||"",document.querySelector("#analytics-chart-title #chart-title").innerHTML="".concat(g," (").concat(p[3],")");else document.querySelector("#analytics-chart-title #chart-title").innerHTML=_analyticsCharts.getChartCaptions(y);var v=f.map(function(t){return{data_label:t.keyname||g,value:t.keyvalue||0}});document.querySelector("#Homepage_CardsList_Wrapper").innerHTML="";o=_analyticsCharts.generateCustomKPIHTML(f,g);document.querySelector("#KPI-2 .row").innerHTML=o;u=e.selectedChartType||(null===(h=document.querySelector(".chart-selections a.bg-success"))||void 0===h?void 0:h.getAttribute("chart_type"));d.push({chartsid:"General",charttype:"chart",chartjson:JSON.stringify(v),chartname:"criteria",chart:u}),_analyticsCharts.chartsJson=d,$("#Homepage_CardsList_Wrapper").show()}else handleNoChartData();callParentNew("LoadIframe");var C={},b={},A="",S="",E={dirLeft:!0,enableMasonry:!1,homePageType:"cards",isCardsDashboard:!0,isMobile:isMobileDevice()},L={css:[],js:[]};L.js.push("/ThirdParty/lodash.min.js"),L.js.push("/ThirdParty/deepdash.min.js"),L.js.push("/Js/handlebars.min.js?v=1"),L.js.push("/Js/handleBarsHelpers.min.js"),L.js.push("/ThirdParty/Highcharts/highcharts.js"),L.js.push("/ThirdParty/Highcharts/highcharts-3d.js"),L.js.push("/ThirdParty/Highcharts/highcharts-more.js"),L.js.push("/ThirdParty/Highcharts/highcharts-exporting.js"),L.js.push("/Js/analytics-charts-functions.min.js?v=24"),L.js.push("/Js/AxInterface.js?v=10"),L.js.push("/ThirdParty/DataTables-1.10.13/media/js/jquery.dataTables.js"),L.js.push("/ThirdParty/DataTables-1.10.13/media/js/dataTables.bootstrap.js"),L.js.push("/ThirdParty/DataTables-1.10.13/extensions/Extras/moment.min.js"),L.css.push("/ThirdParty/fullcalendar/lib/main.min.css"),L.js.push("/ThirdParty/fullcalendar/lib/main.min.js"),E.isMobile&&L.js.push("/ThirdParty/jquery-ui-touch-punch-master/jquery.ui.touch-punch.min.js"),E.enableMasonry&&L.js.push("/ThirdParty/masonry/masonry.pkgd.min.js"),L.js.push("/js/entity-charts.min.js?v=2"),document.getElementsByTagName("body")[0].classList.contains("btextDir-rtl")&&(E.dirLeft=!1),loadAndCall({files:L,callBack:function(){$(function(){ShowDimmer(!0),deepdash(_);if(C.value=JSON.stringify(_analyticsCharts.chartsJson),b.value=JSON.stringify([]),""!=(A="")){A=A.replace(/'/g,"'");var t=parseXml(A),e=xml2json(t,"");S=JSON.parse(e)}appGlobalVarsObject._CONSTANTS.menuConfiguration=$.extend(!0,{},appGlobalVarsObject._CONSTANTS.menuConfiguration,{menuJson:S}),appGlobalVarsObject._CONSTANTS.cardsPage={setCards:!1,cards:[]},$.axpertUI.options.cardsPage.cards=[],appGlobalVarsObject._CONSTANTS.cardsPage=$.extend(!0,{},appGlobalVarsObject._CONSTANTS.cardsPage,{setCards:!0,cards:(JSON.parse(""!==C.value?ReverseCheckSpecialChars(C.value):"[]",function(t,e){try{return"object"===_typeof(e)||isNaN(e)||""===e.toString().trim()?e:"string"==typeof e&&(e.startsWith("0")||e.startsWith("-"))?parseFloat(e,10):JSON.parse(e)}catch(a){return e}})||[]).map(function(t){return _.mapKeys(t,function(t,e){return e.toString().toLowerCase()})}),design:(JSON.parse(""!==b.value?b.value:"[]",function(t,e){try{return"object"===_typeof(e)||isNaN(e)||""===e.toString().trim()?e:"string"==typeof e&&(e.startsWith("0")||e.startsWith("-"))?parseFloat(e,10):JSON.parse(e)}catch(a){return e}})||[]).map(function(t){return _.mapKeys(t,function(t,e){return e.toString().toLowerCase()})}),enableMasonry:E.enableMasonry,staging:{iframes:".splitter-wrapper",cardsFrame:{div:".cardsPageWrapper",cardsDiv:"#Homepage_CardsList_Wrapper",cardsDesigner:".cardsDesigner",cardsDesignerToolbar:".designer",editSaveButton:".editSaveCardDesign",icon:"span.material-icons",divControl:"#arrangeCards"}}});appGlobalVarsObject.lcm;var a=$.axpertUI.init({isHybrid:appGlobalVarsObject._CONSTANTS.isHybrid,isMobile:E.isMobile,compressedMode:appGlobalVarsObject._CONSTANTS.compressedMode,dirLeft:E.dirLeft,axpertUserSettings:{settings:appGlobalVarsObject._CONSTANTS.axpertUserSettings},cardsPage:appGlobalVarsObject._CONSTANTS.cardsPage});appGlobalVarsObject._CONSTANTS.cardsPage=a.cardsPage,ShowDimmer(!1)}),$.axpertUI.cardsPage._addCardHeader=function(t,e){t.find(".card-header").addClass("d-none")}}})}catch(I){console.error("Error processing summary data:",I)}}})}},{key:"getEntityCaption",value:function(t){for(var e=this.selectedEntitiesList,a=0;a<e.length;a++)if(e[a].name===t)return e[a].caption;return""}},{key:"constructSelectedEntityHeader",value:function(){var t='<label id="selectedLabel" class="selected-name">Selected Entities</label>',e="";this.selectedEntitiesList.forEach(function(e,a){_entityCommon.getInitials(e.caption);t+=' <div data-cardname="'.concat(e.caption,'" onclick="toggleSelection(').concat(a,')" class="EntityData_Select-lists col-lg-FV col-md-3 col-sm-12 col-xs-3">\n                                    <div class="EntityData_Select-Items selected">\n\n                                        <h6 class="Entity-title" title="').concat(e.caption,'" value="').concat(e.name,'">\n                                            ').concat(e.caption,"(").concat(e.name,")\n                                        </h6>\n                                    </div>\n\n                                </div>")}),$("#selectedEntitiesContainer").html(t),$.each(this.selectedEntitiesList,function(t,a){var n=0===t?"active":"";_entityCommon.getInitials(a.caption);e+='<li class="nav-item" onclick="selectEntity(this, \''.concat(a.name,'\')" data-cardname="').concat(a.caption,'" dt_transid="').concat(a.name,'">                                \n                                <a class="nav-link ').concat(n,'" href="#">').concat(a.caption,"</a>\n                            </li>")}),$("#dv_EntityContainer").html(e);var a=$("#Data-Group-container .Data-Group_Items:first a"),n=$(a).parent();$(".Data-Group_Items").removeClass("selected"),$(n).addClass("selected");var s=$(".Aggregation-item:first");$(".Aggregation-item").removeClass("selected"),$(s).addClass("selected"),$("#entityModal").modal("hide")}},{key:"constructEntityPopup",value:function(t){var e="";$.each(t,function(t,a){if(!selectedItemsArray.map(function(t){return t.toLowerCase()}).includes(a.name.toLowerCase())){_entityCommon.getInitials(a.caption);e+='<div data-cardname="'.concat(a.caption,'" onclick="selectEntityToAdd(\'').concat(a.caption,"', '").concat(a.name,'\', this)" \n                                class="EntityData_Select-lists col-lg-3 col-md-3 col-sm-12 col-xs-3">\n                                    <div class="EntityData_Select-Items">                                        \n                                        <h6 class="Entity-title" title="').concat(a.caption,'" value="').concat(a.name,'">\n                                            ').concat(a.caption,"(").concat(a.name,")\n                                        </h6>\n                                    </div>\n                                    \n                            </div>")}}),$("#entityDataContainer").html(e),$("#entityModal").modal("show"),$("#entityDataContainer .EntityData_Select-lists").each(function(){var t=$(this).find(".Entity-title").attr("value").toLowerCase();selectedItemsArray.map(function(t){return t.toLowerCase()}).includes(t)&&$(this).hide()})}},{key:"constructXandYAxis",value:function(t,e){var a=this;$("#Data-Group-container").html(""),$("#Aggregation_Wrapper").html("");var n="",s="";s+='<div class="col-lg-3 col-sm-4 Aggregation-Item-wrap agg-count" data-dcname="Count">\n                        <a href="#" class="Aggregation-item" onclick="selectAggField(this)">\n                            <div class="Aggregation-icon">\n                                <span class="material-icons material-icons-style material-icons-2">bar_chart</span>\n                            </div>\n                            <div class="Aggregation-content">\n                                <h6 class="subtitle"  data-fldname="Count">Count</h6>\n                            </div>\n                        </a>\n                    </div>',n+='<div class="Data-Group_Items group-all" data-dcname="All">\n                        <a href="#" class="group-item" onclick="selectGroupField(this)">\n                            <div class="d-flex">\n                                <div class="symbol symbol-40px symbol-circle me-5" style="margin-left:5px !important;">\n                                    <div class="symbol-label bgs1">\n                                        <span class="material-icons material-icons-style material-icons-2">date_range</span>\n                                    </div>\n                                </div>\n                                <div class="d-flex flex-column y-axis-caption">\n                                    <span class="Data-Group-name" nonmandatory="F" normalized="F" data-fldname="All" srctbl="All" srcfld="All">All</span>\n                                </div>\n                            </div>\n                        </a>\n                      </div>';var i=this.xAxisFields&&""!==this.xAxisFields.trim()&&"All"!==this.xAxisFields.trim()?this.xAxisFields.split(","):[],r=this.yAxisFields&&""!==this.yAxisFields.trim()&&"All"!==this.yAxisFields.trim()?this.yAxisFields.split(","):[];function o(t){return i.includes(t)?i.indexOf(t):r.includes(t)?r.indexOf(t)+i.length:-1}if(i.length>0){var c=t.filter(function(t){return i.includes(t.fldname)}).sort(function(t,e){return o(t.fldname)-o(e.fldname)});$.each(c,function(t,e){"T"===e.aggfield&&(s+=a.getAggFldHtml(e))})}else $.each(t,function(t,e){"T"===e.aggfield&&"F"===e.hide&&(s+=a.getAggFldHtml(e))});if(r.length>0){var l=t.filter(function(t){return r.includes(t.fldname)}).sort(function(t,e){return o(t.fldname)-o(e.fldname)});$.each(l,function(t,e){"T"!==e.grpfield||"DropDown"!==e.cdatatype&&"c"!==e.fdatatype&&"d"!==e.fdatatype||(n+=a.getGroupFldHtml(e))})}else $.each(t,function(t,e){"T"!==e.grpfield||"F"!==e.hide||"DropDown"!==e.cdatatype&&"c"!==e.fdatatype&&"d"!==e.fdatatype||(n+=a.getGroupFldHtml(e))});if($("#Data-Group-container").html(n),$("#Aggregation_Wrapper").html(s),"Entity Selection"===e||"Page Load"===e){var d=t.find(function(t){return t.ftransid}),u=d?d.ftransid:"default";_analyticsCharts.getAnalyticsChartsDataWS({page:"Analytics",transId:u,aggField:"count",aggTransId:u,groupField:"all",groupTransId:u,aggFunc:"count"});var h=$("#Data-Group-container .Data-Group_Items:first a"),m=$(h).parent();$(".Data-Group_Items").removeClass("selected"),$(m).addClass("selected");var f=$(".Aggregation-item:first");$(".Aggregation-item").removeClass("selected"),$(f).addClass("selected")}"Entity Selection"===e&&$("#entityModal").modal("hide")}},{key:"getGroupFldHtml",value:function(t){return'\n        <div class="Data-Group_Items" data-fldname="'.concat(t.fldname,'" data-dcname="').concat(t.dcname,'" data-griddc="').concat(t.griddc,'">\n            <a href="#" class="group-item" onclick="selectGroupField(this)" >\n                <div class="d-flex ">\n                    <div class="symbol symbol-40px symbol-circle me-5" style="margin-left:5px !important;">\n                        <div class="symbol-label bgs1">\n                            <span class="material-icons material-icons-style material-icons-2">date_range</span>\n                        </div>\n                    </div>\n                    <div class="d-flex flex-column y-axis-caption">\n                        <span class="Data-Group-name" data-fldname="').concat(t.fldname,'">').concat(t.fldcap||t.fldname,"</span>\n                    </div>\n                </div>\n            </a>\n        </div>")}},{key:"getAggFldHtml",value:function(t){return'\n        <div class="col-lg-3 col-sm-4 Aggregation-Item-wrap" data-fldname="'.concat(t.fldname,'" data-dcname="').concat(t.dcname,'" data-griddc="').concat(t.griddc,'">\n            <a href="#" class="Aggregation-item" onclick="selectAggField(this)">\n                <div class="Aggregation-icon">\n                    <span class="material-icons material-icons-style material-icons-2">bar_chart</span>\n                </div>\n                <div class="Aggregation-content">\n                    <h6 class="subtitle"  data-fldname="').concat(t.fldname,'" >').concat(t.fldcap||t.fldname,'</h6>\n                </div>\n                <div class="Aggregation-icon2">\n                    <button type="button" onclick="handleFuncSelection(event,this)" class="btn btn-icon btn-white btn-color-gray-600 btn-active-primary shadow-sm tb-btn btn-sm bg-success" agg_function="sum" title="Sum">\n                        <span class="material-icons material-icons-style material-icons-2">functions</span>\n                    </button>\n                    <button type="button" onclick="handleFuncSelection(event,this)" class="btn btn-icon btn-white btn-color-gray-600 btn-active-primary shadow-sm tb-btn btn-sm" agg_function="avg" title="Average">\n                        <span class="material-icons material-icons-style material-icons-2">percent</span>\n                    </button>\n                </div>\n            </a>\n        </div>')}},{key:"getUrlParams",value:function(){var t=window.location.search,e=new URLSearchParams(t);this.entityName=e.get("ename")}},{key:"getAllEntities",value:function(){var t=this,e=this;this.callAPI("../aspx/Analytics.aspx/GetEntityListWS",{},!0,function(a){if(a.success){var n=JSON.parse(JSON.parse(a.response).d);e.allEntitiesList=n.result.list,e.constructEntityPopup(t.allEntitiesList)}else console.log("Error fetching all entity list")})}},{key:"reloadAnalyticsPage",value:function(){parent.ShowDimmer(!0),_entityCommon.loadHyperLink("../aspx/Analytics.aspx")}},{key:"callAPI",value:function(t,e,a,n){var s=this,i=new XMLHttpRequest;i.open("POST",t,a),i.setRequestHeader("Content-Type","application/json;charset=UTF-8"),s.isAxpertFlutter&&(i.setRequestHeader("Authorization","Bearer ".concat(armToken)),e.armSessionId=armSessionId),i.onreadystatechange=function(){4==this.readyState&&(200==this.status?n({success:!0,response:this.responseText}):(s.catchError(this.responseText),n({success:!1,response:this.responseText})))},i.send(JSON.stringify(e))}},{key:"catchError",value:function(t){showAlertDialog("error",t)}},{key:"showSuccess",value:function(t){showAlertDialog("success",t)}},{key:"dataConvert",value:function(t,e){if("AXPERT"==e)try{if("undefined"!=typeof(t=JSON.parse(t.d)).result[0].result.row)return t.result[0].result.row;if("undefined"!=typeof t.result[0].result)return t.result[0].result}catch(a){ShowDimmer(!1),this.catchError(a.message)}else if("ARM"==e)try{if(this.isAxpertFlutter||(t=JSON.parse(t.d)),t.result&&t.result.success){if(!_entityCommon.isUndefined(t.result.data))return t.result.data}else _entityCommon.isUndefined(t.result.message)||this.catchError(t.result.message)}catch(a){ShowDimmer(!1),this.catchError(a.message)}return t}},{key:"generateCustomKPIHTML",value:function(t,e){var a="",n=null!==document.querySelector(".Data-Group_Items.group-all.selected");return t.forEach(function(t){var s,i=t.criteria||"",r=i.split("~"),o=r[1]?r[1].trim():"",c=r[2]?r[2].trim():"",l=(t.keyname||e||"").trim(),d=t.keyvalue;if(n&&(""===l||"empty data"===l.toLowerCase())){var u=_analyticsCharts.getChartCaptions(i)||"";""!==u.trim()&&(l=u.trim())}(""!==l&&"empty data"!==l.toLowerCase()||""!==d&&null!==d&&d!==undefined&&0!==d)&&(a+='\n                <div class="col-xl-12 col-lg-12 col-sm-12 Invoice-content-wrap">\n                    <a href="#" class="Invoice-item">\n                        <div class="Invoice-icon">\n                            <span class="material-icons material-icons-style material-icons-2">bar_chart</span>\n                        </div>\n                        <div class="Invoice-content">\n            ',""!==l&&"empty data"!==l.toLowerCase()&&(a+='\n                    <h6 class="subtitle" data-keyname="'.concat(l,'"\n                        onclick="navigateToListPage(\'').concat(o,"', '").concat(c,"', this)\">\n                        ").concat(l,"\n                    </h6>")),a+='\n                            <h3 class="title">'.concat((null===(s=t.keyvalue)||void 0===s?void 0:s.toLocaleString())||0,'</h3>\n                        </div>\n                        <div class="Invoice-icon2"></div>\n                    </a>\n                </div>\n            '))}),a}},{key:"generateGeneralKPIHTML",value:function(t){var e="";return e+='\n        <div class="col-xl-12 col-lg-12 col-sm-12 Invoice-content-wrap">\n            <a href="#" class="Invoice-item">\n                <div class="Invoice-icon">\n                    <span class="material-icons material-icons-style material-icons-2">bar_chart</span>\n                </div>\n                <div class="Invoice-content">\n                    <h6 class="subtitle" onclick="navigateToPeriod(\'total\')">Total</h6>\n                    <h3 class="title">'.concat(t.totrec||0,'</h3>\n                </div>\n                <div class="Invoice-icon2"></div>\n            </a>\n        </div>\n    '),0!==t.cyear&&(e+='\n            <div class="col-xl-12 col-lg-12 col-sm-12 Invoice-content-wrap">\n                <a href="#" class="Invoice-item">\n                    <div class="Invoice-icon">\n                        <span class="material-icons material-icons-style material-icons-2">bar_chart</span>\n                    </div>\n                    <div class="Invoice-content">\n                        <h6 class="subtitle" onclick="navigateToPeriod(\'this_yearOption\')">This year</h6>\n                        <h3 class="title">'.concat(t.cyear||0,'</h3>\n                    </div>\n                    <div class="Invoice-icon2"></div>\n                </a>\n            </div>\n        ')),0!==t.cmonth&&(e+='\n            <div class="col-xl-12 col-lg-12 col-sm-12 Invoice-content-wrap">\n                <a href="#" class="Invoice-item">\n                    <div class="Invoice-icon">\n                        <span class="material-icons material-icons-style material-icons-2">bar_chart</span>\n                    </div>\n                    <div class="Invoice-content">\n                        <h6 class="subtitle" onclick="navigateToPeriod(\'this_monthOption\')">This month</h6>\n                        <h3 class="title">'.concat(t.cmonth||0,'</h3>\n                    </div>\n                    <div class="Invoice-icon2"></div>\n                </a>\n            </div>\n        ')),0!==t.cweek&&(e+='\n            <div class="col-xl-12 col-lg-12 col-sm-12 Invoice-content-wrap">\n                <a href="#" class="Invoice-item">\n                    <div class="Invoice-icon">\n                        <span class="material-icons material-icons-style material-icons-2">bar_chart</span>\n                    </div>\n                    <div class="Invoice-content">\n                        <h6 class="subtitle" onclick="navigateToPeriod(\'this_weekOption\')">This week</h6>\n                        <h3 class="title">'.concat(t.cweek||0,'</h3>\n                    </div>\n                    <div class="Invoice-icon2"></div>\n                </a>\n            </div>\n        ')),0!==t.cyesterday&&(e+='\n            <div class="col-xl-12 col-lg-12 col-sm-12 Invoice-content-wrap">\n                <a href="#" class="Invoice-item">\n                    <div class="Invoice-icon">\n                        <span class="material-icons material-icons-style material-icons-2">bar_chart</span>\n                    </div>\n                    <div class="Invoice-content">\n                        <h6 class="subtitle" onclick="navigateToPeriod(\'yesterdayOption\')">Yesterday</h6>\n                        <h3 class="title">'.concat(t.cyesterday||0,'</h3>\n                    </div>\n                    <div class="Invoice-icon2"></div>\n                </a>\n            </div>\n        ')),0!==t.ctoday&&(e+='\n            <div class="col-xl-12 col-lg-12 col-sm-12 Invoice-content-wrap">\n                <a href="#" class="Invoice-item">\n                    <div class="Invoice-icon">\n                        <span class="material-icons material-icons-style material-icons-2">bar_chart</span>\n                    </div>\n                    <div class="Invoice-content">\n                        <h6 class="subtitle" onclick="navigateToPeriod(\'todayOption\')">Today</h6>\n                        <h3 class="title">'.concat(t.ctoday||0,'</h3>\n                    </div>\n                    <div class="Invoice-icon2"></div>\n                </a>\n            </div>\n        ')),e}},{key:"filterByFldname",value:function(t,e){return t.filter(function(t){return t.fldname===e})}},{key:"getChartCriteria",value:function(t){return t.split("~~").slice(0,4).join("~~")}},{key:"getChartCaptions",value:function(t){if(!this.selectedChartsObj[t]){var e=t.split("~"),a=this.filterByFldname(this.metaData,e[2]),n=this.filterByFldname(this.metaData,e[9]),s=e[0],i="";i=0===a.length||""==e[2]?"count"===s?"".concat(this.entityName," (Count)"):"".concat(n[0].fldcap||""," (").concat(s,")"):"count"===s?"".concat(a[0].fldcap||""," wise ").concat(s):"".concat(a[0].fldcap||""," wise ").concat(n[0].fldcap||""," (").concat(s,")"),this.selectedChartsObj[t]=i}return this.selectedChartsObj[t]}},{key:"checkAppmanagerAccess",value:function(){_entityCommon.isAppManager()||(document.querySelector("#Entity_Summary_Wrapper .card-header .Tkts-toolbar-Right").innerHTML="")}}]),t}();function applyEntitySearch(){var t=$("#searchEntity").val().trim().toLowerCase();""===t?$("#entityDataContainer .EntityData_Select-lists, #selectedEntitiesContainer .EntityData_Select-lists").removeClass("d-none"):($("#entityDataContainer .EntityData_Select-lists").addClass("d-none"),$("#entityDataContainer").find(".EntityData_Select-lists").filter(function(){return $(this).text().toLowerCase().indexOf(t)>-1}).removeClass("d-none"),$("#selectedEntitiesContainer .EntityData_Select-lists").addClass("d-none"),$("#selectedEntitiesContainer").find(".EntityData_Select-lists").filter(function(){return $(this).text().toLowerCase().indexOf(t)>-1}).removeClass("d-none"))}function selectGroupField(t){var e=$(t).parent();$(".Data-Group_Items").removeClass("selected"),$(e).addClass("selected");var a=$(t).find(".Data-Group-name").attr("data-fldname").toLowerCase(),n=$(".Aggregation-item.selected").find(".subtitle").attr("data-fldname").toLowerCase(),s=_analyticsCharts.metaData.find(function(t){return t.fldname===a}),i="all"===a?"all":a,r=n||"count",o=$(".Aggregation-item.selected").find("button.bg-success").attr("agg_function")||"count",c="all"===a?_analyticsCharts.entityTransId:s?s.ftransid:null;i&&r&&c?("all"===i||s&&"F"===s.griddc?showAllXAxis():constructXandYAxisForSelectedGroup(i),_analyticsCharts.getAnalyticsChartsDataWS({page:"Analytics",transId:c,aggField:r,aggTransId:c,groupField:i,groupTransId:c,aggFunc:o})):console.error("One or more required fields are missing from the selected item.")}function constructXandYAxisForSelectedGroup(t){document.querySelectorAll(".Aggregation-Item-wrap").forEach(function(e){e.classList.add("d-none");var a=e.dataset.dcname;"Count"!=a&&a!=t||e.classList.remove("d-none")});var e=document.querySelector(".Aggregation-item.selected");e.closest(".Aggregation-Item-wrap").classList.contains("d-none")&&(e.classList.remove("selected"),document.querySelector(".agg-count .Aggregation-item").classList.add("selected"))}function showAllXAxis(){document.querySelectorAll(".Aggregation-Item-wrap.d-none").forEach(function(t){t.classList.remove("d-none")})}function selectEntityToAdd(t,e,a){var n=$(a).find(".EntityData_Select-Items");n.hasClass("selected")?(n.removeClass("selected"),selectedItemsArray.includes(e)&&(selectedItemsArray=selectedItemsArray.filter(function(t){return t!==e}))):(n.addClass("selected"),selectedItemsArray.includes(e)||selectedItemsArray.push(e))}function selectAggField(t,e){$(".Aggregation-item").removeClass("selected"),$(t).addClass("selected");var a=$(t).find(".subtitle").attr("data-fldname"),n=$(".Data-Group_Items.selected").attr("data-fldname"),s=_analyticsCharts.metaData.find(function(t){return t.fldname===a}),i="all",r="count",o="count",c=null;"Count"===a?(i=n||"all",r="count",o="count",c=_analyticsCharts.entityTransId):s&&(o=$(t).find("button.bg-success").attr("agg_function"),i=n||"all",r=a,c=s.ftransid),i&&r&&o&&("count"===a||c)?_analyticsCharts.getAnalyticsChartsDataWS({page:"Analytics",transId:c,aggField:r,aggTransId:c,groupField:i,groupTransId:c,aggFunc:o,chartType:e}):console.error("One or more required fields are missing from the selected item.")}function handleFuncSelection(t,e){t.stopPropagation(),e.closest(".Aggregation-icon2").querySelectorAll("button").forEach(function(t){t.classList.remove("bg-success")}),e.classList.add("bg-success"),e.closest(".Aggregation-item").click()}function chartSelectionClick(t,e){t.stopPropagation();var a=e.closest(".chart-selections");a.querySelectorAll("a").forEach(function(t){t.classList.remove("bg-success")}),e.classList.add("bg-success");var n=e.getAttribute("chart_type"),s=$(".Aggregation-item.selected").get(0),i="",r="";switch(n){case"pie":i="Pie",r="pie_chart";break;case"column":i="Column",r="bar_chart";break;case"bar":i="Bar",r="bar_chart";break;case"line":i="Line ",r="show_chart";break;default:i="Pie",r="pie_chart"}var o=a.querySelector(".btn.dropdown-toggle");o&&(o.querySelector(".chart-name").textContent=i,o.querySelector(".material-icons").textContent=r),s?selectAggField(s,n):console.error("No aggregation field is selected."),_analyticsCharts.selectedChartType=n,storeChartType(n)}function storeChartType(t){var e={page:"Analytics",transId:_analyticsCharts.entityTransId,properties:{CHARTTYPE:t},confirmNeeded:!1,allUsers:!0};_entityCommon.setAnalyticsDataWS(e,function(){},function(t){showAlertDialog("error",t.status+" "+t.statusText)})}function entityModelClose(){$("#entityModal").modal("hide")}function resetSelection(){$("#entityDataContainer .selected").removeClass("selected");_entityCommon.setAnalyticsDataWS({page:"Analytics",transId:"",properties:{ENTITIES:""},confirmNeeded:!0,allUsers:!1},function(){window.location.reload()},function(t){showAlertDialog("error",t.status+" "+t.statusText)})}function saveSelectedEntities(){var t=_analyticsCharts.selectedEntitiesList.filter(function(t){return!t.toBeRemoved});_analyticsCharts.selectedEntitiesList.forEach(function(t){t.toBeRemoved=!1});var e=t.map(function(t){return t.name}).concat(selectedItemsArray);if(e.length>0){selectedItemsArray=e,$("#entityDataContainer .EntityData_Select-lists").each(function(){var t=$(this).find(".Entity-title").attr("value").toLowerCase();e.map(function(t){return t.toLowerCase()}).includes(t)&&$(this).hide()});var a={page:"Analytics",transId:"",properties:{ENTITIES:e.join(",")},confirmNeeded:!0,allUsers:!1};_entityCommon.setAnalyticsDataWS(a,function(){window.location.reload()},function(t){showAlertDialog("error",t.status+" "+t.statusText)})}else showAlertDialog("error","Please select at least one entity to proceed.")}function selectEntity(t,e){document.querySelectorAll("#dv_EntityContainer .nav-link.active").forEach(function(t){return t.classList.remove("active")}),t.querySelector(".nav-link").classList.add("active"),_analyticsCharts.entityTransId=e,_analyticsCharts.entityName=_analyticsCharts.getEntityCaption(e),fetchEntityData(e)}function moveselection(t){var e,a=$(".Aggregation-item.selected").closest(".Aggregation-Item-wrap");switch(t){case"left":0===(e=a.prev(".Aggregation-Item-wrap")).length&&(e=$("#Aggregation_Wrapper .Aggregation-Item-wrap").last());break;case"right":0===(e=a.next(".Aggregation-Item-wrap")).length&&(e=$("#Aggregation_Wrapper .Aggregation-Item-wrap").first())}e&&e.length>0&&($(".Aggregation-item").removeClass("selected"),e.find(".Aggregation-item").addClass("selected"),e.find(".Aggregation-item").click())}function reloadPage(){window.location.reload()}function ShowDimmer(t){DimmerCalled=!0;var e=$("#waitDiv");if(e.length>0&&e!=undefined)if(1==t){var a=$("#middle1",parent.document);a&&e.width(a.width()),e.show(),document.onkeydown=function(){return!1}}else e.hide(),document.onkeydown=function(){if(1==DimmerCalled)return!0};else window.opener!=undefined&&(e=$("#waitDiv",window.opener.document)).length>0&&(1==t?e.show():e.hide());DimmerCalled=!1}function openEntitySelection(){""==$("#entityDataContainer").html()?_analyticsCharts.getAllEntities():$("#entityModal").modal("show")}function openFieldSelection(){$("#fieldsModal").modal("show"),createFieldsLayout()}function createFieldsLayout(){var t=document.getElementById("fields-selection"),e=_analyticsCharts.xAxisFields||"All",a=_analyticsCharts.yAxisFields||"All",n=["transid"],s="All"===e?[]:e.split(","),i="All"===a?[]:a.split(","),r=_analyticsCharts.metaData.filter(function(t){return"T"===t.grpfield&&("DropDown"===t.cdatatype||"c"===t.fdatatype||"d"===t.fdatatype)&&-1==n.indexOf(t.fldname)});function o(t,e){return t.sort(function(t,a){var n=e.includes(t.fldname),s=e.includes(a.fldname);return n&&!s?-1:!n&&s?1:e.indexOf(t.fldname)-e.indexOf(a.fldname)})}var c=o(_analyticsCharts.metaData.filter(function(t){return"T"===t.aggfield&&-1==n.indexOf(t.fldname)}),s),l=o(r,i),d="";c.length&&(d+='\n        <div class="card KC_Items">\n            <div class="card-header collapsible cursor-pointer rotate" data-bs-toggle="collapse" aria-expanded="true" data-bs-target="#fields-aggFields">\n                <h3 class="card-title">Aggregate Fields (X-axis)</h3>\n                <div class="card-toolbar rotate-180">\n                    <span class="material-icons material-icons-style material-icons-2">expand_circle_down</span>\n                </div>\n            </div>\n            <div class="KC_Items_Content collapse show heightControl pt-0---" id="fields-aggFields">\n            <table class="table table-hover">\n                <tbody id="fields-table-body">',c.forEach(function(t){var e="".concat("T"==t.hide?"(Hidden)":""),a="(Hidden)"==e?"chk-Hiddenfld":"",n="".concat(t.fldcap||"","  (").concat(t.fldname,")  (").concat(t.dcname,") ").concat(e);d+='<tr><td><input type="checkbox" id="chk_'.concat(t.fldname,'" class="chk-fields chk-relateddataflds ').concat(a,' chk-aggfld" value="').concat(t.fldname,'" data-fldcap="').concat(t.fldcap||"",'" data-dcno="').concat(t.dcname,'"></td>\n            <td><label for="chk_').concat(t.fldname,'">').concat(n,"</label></td></tr>")}),d+="</tbody></table></div></div>"),l.length&&(d+='\n        <div class="card KC_Items">\n            <div class="card-header collapsible cursor-pointer rotate" data-bs-toggle="collapse" aria-expanded="true" data-bs-target="#fields-grpFields">\n                <h3 class="card-title">Group Fields (Y-axis)</h3>\n                <div class="card-toolbar rotate-180">\n                    <span class="material-icons material-icons-style material-icons-2">expand_circle_down</span>\n                </div>\n            </div>\n            <div class="KC_Items_Content collapse show heightControl pt-0---" id="fields-grpFields">\n            <table class="table table-hover">\n                <tbody id="fields-table-body">',l.forEach(function(t){var e="".concat("T"==t.hide?"(Hidden)":""),a="(Hidden)"==e?"chk-Hiddenfld":"",n="".concat(t.fldcap||"","  (").concat(t.fldname,")  (").concat(t.dcname,") ").concat(e);d+='<tr><td><input type="checkbox" id="chk_'.concat(t.fldname,'" class="chk-fields chk-relateddataflds ').concat(a,' chk-grpfld" value="').concat(t.fldname,'" data-fldcap="').concat(t.fldcap||"",' data-dcno="').concat(t.dcname,'"></td>\n            <td><label for="chk_').concat(t.fldname,'">').concat(n,"</label></td></tr>")}),d+="</tbody></table></div></div>"),t.innerHTML=d,"All"===e&&document.querySelectorAll(".chk-aggfld:not(.chk-Hiddenfld)").forEach(function(t){t.checked=!0}),"All"===a&&document.querySelectorAll(".chk-grpfld:not(.chk-Hiddenfld)").forEach(function(t){t.checked=!0}),s.forEach(function(t){if("All"!==t){var e=document.querySelector("#chk_".concat(t));e?e.checked=!0:console.warn("Checkbox with ID #chk_".concat(t," not found."))}}),i.forEach(function(t){if("All"!==t){var e=document.querySelector("#chk_".concat(t));e?e.checked=!0:console.warn("Checkbox with ID #chk_".concat(t," not found."))}});var u=document.querySelectorAll(".chk-fields");u.forEach(function(t){t.addEventListener("change",function(){var t=u.length===document.querySelectorAll(".chk-fields:checked").length;document.querySelector("#check-all").checked=t})});var h=document.getElementById("check-all");h.addEventListener("change",function(){var t=h.checked;u.forEach(function(e){e.checked=t})})}function applyFields(){var t=document.querySelectorAll(".chk-fields:checked");if(0!==t.length){var e=document.getElementById("fields-aggFields"),a=document.getElementById("fields-grpFields"),n=[],s=[];t.forEach(function(t){var i=t.value;t.closest(".card")&&(e&&e.contains(t.closest("div"))?n.push(i):a&&a.contains(t.closest("div"))&&s.push(i))}),n=n.join(","),s=s.join(",");var i={page:"Analytics",transId:_analyticsCharts.entityTransId,properties:{XAXISFIELDS:n,YAXISFIELDS:s},confirmNeeded:!0,allUsers:!1};_entityCommon.setAnalyticsDataWS(i,function(){var t=_analyticsCharts.entityTransId,e=document.querySelector('[dt_transid="'.concat(t,'"]'));e?(fieldsModelClose(),selectEntity(e,t)):console.error('Element with dt_transid="'.concat(t,'" not found'))},function(t){showAlertDialog("error",t.status+" "+t.statusText)})}else showAlertDialog("error","Error: No fields are selected.")}function resetFields(){document.querySelectorAll(".chk-fields , #check-all").forEach(function(t){t.checked=!0});var t={page:"Analytics",transId:_analyticsCharts.entityTransId,properties:{XAXISFIELDS:"All",YAXISFIELDS:"All"},confirmNeeded:!0,allUsers:!1};_entityCommon.setAnalyticsDataWS(t,function(){var t=_analyticsCharts.entityTransId,e=document.querySelector('[dt_transid="'.concat(t,'"]'));e?(fieldsModelClose(),selectEntity(e,t)):console.error('Element with dt_transid="'.concat(t,'" not found'))},function(t){showAlertDialog("error",t.status+" "+t.statusText)})}function fieldsModelClose(){$("#fieldsModal").modal("hide")}function toggleSelection(t){var e=_analyticsCharts.selectedEntitiesList[t];e.toBeRemoved=!e.toBeRemoved,$("#selectedEntitiesContainer .EntityData_Select-lists:eq(".concat(t,")")).find(".EntityData_Select-Items").toggleClass("selected");var a=_analyticsCharts.selectedEntitiesList.some(function(t){return!t.toBeRemoved});$(".selcted").toggle(a),e.toBeRemoved||$("#entityDataContainer .EntityData_Select-lists").each(function(){var t=$(this).find(".EntityData_Select-Items").text().trim().toLowerCase();console.log("Showing entity: ".concat(t)),t===e.name.toLowerCase()&&$(this).show()})}function navigateToListPage(t,e,a){if(_entityCommon.inValid(e)){_analyticsCharts.selectedEntitiesList.find(function(e){return e.name===t}).caption;loadEntityPage("../aspx/Entity.aspx?tstid=".concat(t))}else{var n=a.getAttribute("data-keyname");if(_analyticsCharts.selectedEntitiesList&&e){var s=_analyticsCharts.selectedEntitiesList.find(function(e){return e.name===t});if(s){s.caption;loadEntityPage("../aspx/Entity.aspx?tstid=".concat(t,"&filterval=").concat(n,"&filterfld=").concat(e,"&applyfilter=true"))}else console.error("Entity not found for transid: ".concat(t))}else console.error("selectedEntitiesList or fldname is undefined")}}function navigateToPeriod(t){var e=_analyticsCharts.entityTransId;if(_analyticsCharts.selectedEntitiesList){var a=_analyticsCharts.selectedEntitiesList.find(function(t){return t.name===e});if(a){a.caption;var n="../aspx/Entity.aspx?tstid=".concat(e);if("total"!==t.trim().toLowerCase()){var s=_entityCommon.getDatesBasedonSelectionForBetweenFilter(t);s.from=moment(s.from,advFilterDtCulture).format("DD-MMM-YYYY"),s.to=moment(s.to,advFilterDtCulture).format("DD-MMM-YYYY"),n+="&filterfrom=".concat(s.from,"&filterto=").concat(s.to,"&filterfld=modifiedon&filtertype=date&applyfilter=true")}loadEntityPage(n)}else console.error("Entity not found for transid: ".concat(e))}else console.error("selectedEntitiesList is undefined")}function loadEntityPage(t){parent.ShowDimmer(!0),_entityCommon.loadHyperLink(t)}function handleNoChartData(){document.querySelectorAll(".analytics-container").forEach(function(t){t.classList.add("d-none")}),document.querySelector(".nodata").classList.remove("d-none")}function handleValidChartData(){document.querySelectorAll(".analytics-container").forEach(function(t){t.classList.remove("d-none")});var t=document.querySelector(".nodata");t&&t.classList.add("d-none")}function fetchEntityData(t,e){$.ajax({url:top.window.location.href.toLowerCase().substring(0,top.window.location.href.toLowerCase().indexOf("/aspx/"))+"/aspx/Analytics.aspx/GetAnalyticsEntityWS",type:"POST",cache:!1,async:!0,dataType:"json",data:JSON.stringify({page:"Analytics",transId:t}),contentType:"application/json",success:function(t){if(t&&t.d){var e=JSON.parse(t.d),a=e.result.data.Properties,n=a.XAXISFIELDS,s=a.YAXISFIELDS;_analyticsCharts.xAxisFields=n||"All",_analyticsCharts.yAxisFields=s||"All",_analyticsCharts.metaData=e.result.data.MetaData,_analyticsCharts.entityTransId=e.result.data.TransId,_analyticsCharts.entityName=_analyticsCharts.getEntityCaption(_analyticsCharts.entityTransId),_analyticsCharts.constructXandYAxis(_analyticsCharts.metaData,"Page Load")}},error:function(t){console.error("Error fetching entity data:",t)}})}function openFilters(){var t=_analyticsCharts.metaData,e=_analyticsCharts.filterObj;_entityFilter.metadata=t,_entityFilter.containerId="dvModalFilter",_entityFilter.filterObj=e,_entityFilter.createFilterLayout(),$("#applyFilterButton").on("click",function(){_entityFilter.handleApply()}),$("#filterModal").modal("show")}function filterModelClose(){$("#filterGroupName").val(""),$("#filterGroupModalWrapper").modal("hide"),$("#dvModalFilter").html(""),$("#filterModal").modal("hide")}function scrollLeft(){document.querySelector(".scrollable-menu").scrollBy({left:-200,behavior:"smooth"})}function scrollRight(){document.querySelector(".scrollable-menu").scrollBy({left:200,behavior:"smooth"})}$(document).ready(function(){_entityFilter=new EntityFilter,_entityCommon=new EntityCommon,(_analyticsCharts=new AnalyticsCharts).init(),$("#searchEntity").keyup(function(){applyEntitySearch()}).change(function(){applyEntitySearch()}),$(document).keydown(function(t){switch(t.which){case 37:moveselection("left");break;case 38:moveselection("up");break;case 39:moveselection("right");break;case 40:moveselection("down");break;default:return}t.preventDefault()})}),document.addEventListener("DOMContentLoaded",function(){var t=document.getElementById("dv_EntityContainer"),e="",a="";function n(t){(a=(e=this).cloneNode(!0)).classList.add("drag-image"),document.body.appendChild(a),t.dataTransfer.effectAllowed="move",t.dataTransfer.setDragImage(a,0,0),t.dataTransfer.setData("text/html",this.innerHTML),this.classList.add("dragging")}function s(t){return t.preventDefault&&t.preventDefault(),t.dataTransfer.dropEffect="move",!1}function i(t){this!==e&&this.classList.add("over")}function r(t){this.classList.remove("over")}function o(n){if(n.stopPropagation&&n.stopPropagation(),e!==this){var s=Array.from(t.querySelectorAll(".nav-item"));s.indexOf(e)<s.indexOf(this)?this.after(e):this.before(e)}a&&a.parentNode&&a.parentNode.removeChild(a);var i={page:"Analytics",transId:"",properties:{ENTITIES:Array.from(t.querySelectorAll(".nav-item")).map(function(t){return t.getAttribute("dt_transid")}).join(",")},confirmNeeded:!0,allUsers:!1};return _entityCommon.setAnalyticsDataWS(i,function(){},function(t){showAlertDialog("error",t.status+" "+t.statusText)}),!1}function c(t){this.classList.remove("dragging"),d.forEach(function(t){t.classList.remove("over")}),a&&a.parentNode&&a.parentNode.removeChild(a)}function l(t){t.addEventListener("dragstart",n,!1),t.addEventListener("dragenter",i,!1),t.addEventListener("dragover",s,!1),t.addEventListener("dragleave",r,!1),t.addEventListener("drop",o,!1),t.addEventListener("dragend",c,!1)}var d=t.querySelectorAll(".nav-item");d.forEach(function(t){t.setAttribute("draggable","true"),l(t)}),new MutationObserver(function(t){t.forEach(function(t){t.addedNodes.length&&t.addedNodes.forEach(function(t){1===t.nodeType&&t.classList.contains("nav-item")&&(t.setAttribute("draggable","true"),l(t))})})}).observe(t,{childList:!0})}),document.addEventListener("DOMContentLoaded",function(){var t=document.getElementById("Data-Group-container"),e="",a=null;function n(t){e=this,t.dataTransfer.effectAllowed="move",(a=this.cloneNode(!0)).style.position="absolute",a.style.top="-1000px",document.body.appendChild(a),t.dataTransfer.setDragImage(a,t.offsetX,t.offsetY),this.classList.add("dragging")}function s(t){return t.preventDefault&&t.preventDefault(),t.dataTransfer.dropEffect="move",!1}function i(t){this!==e&&this.classList.add("over")}function r(t){this.classList.remove("over")}function o(a){if(a.stopPropagation&&a.stopPropagation(),e!==this){var n=Array.from(t.querySelectorAll(".Data-Group_Items:not(.first-item):not(.selected)"));n.indexOf(e)<n.indexOf(this)?this.after(e):this.before(e),n.forEach(function(t){var e=t.querySelector(".material-icons");e&&(e.style.color=t.dataset.initialColor)});var s=Array.from(t.querySelectorAll(".Data-Group_Items:not(.first-item):not(.selected)")).map(function(t){return t.getAttribute("data-fldname")});console.log("Updated yOrder:",s);var i=e.getAttribute("data-fldname");console.log("Selected fldname:",i);var r=_analyticsCharts.metaData.find(function(t){return t.fldname===i});if(r){var o=r.ftransid;console.log("Found ftransid:",o);var c={page:"Analytics",transId:o,properties:{YAXISFIELDS:s.join(",")},allUsers:!1};_entityCommon.setAnalyticsDataWS(c,function(){},function(t){showAlertDialog("error",t.status+" "+t.statusText)})}else console.warn("Metadata item not found for selected fldname:",i)}return!1}function c(e){this.classList.remove("dragging"),Array.from(t.querySelectorAll(".Data-Group_Items:not(.first-item):not(.selected)")).forEach(function(t){t.classList.remove("over")}),a&&(document.body.removeChild(a),a=null)}function l(t){t.addEventListener("dragstart",n,!1),t.addEventListener("dragenter",i,!1),t.addEventListener("dragover",s,!1),t.addEventListener("dragleave",r,!1),t.addEventListener("drop",o,!1),t.addEventListener("dragend",c,!1)}var d=t.querySelector(".Data-Group_Items:first-child");d&&d.classList.add("first-item"),t.querySelectorAll(".Data-Group_Items:not(.first-item):not(.selected)").forEach(function(t){t.setAttribute("draggable","true");var e=t.querySelector(".material-icons");e&&(t.dataset.initialColor=window.getComputedStyle(e).color),l(t)}),new MutationObserver(function(t){t.forEach(function(t){t.addedNodes.length&&t.addedNodes.forEach(function(t){if(t.classList&&t.classList.contains("Data-Group_Items")&&!t.classList.contains("selected")&&!t.classList.contains("first-item")){t.setAttribute("draggable","true");var e=t.querySelector(".material-icons");e&&(t.dataset.initialColor=window.getComputedStyle(e).color),l(t)}})})}).observe(t,{childList:!0})}),document.addEventListener("DOMContentLoaded",function(){var t=document.getElementById("Aggregation_Wrapper"),e="",a=null;function n(t){"false"!==this.getAttribute("draggable")&&(e=this,t.dataTransfer.effectAllowed="move",(a=this.cloneNode(!0)).style.position="absolute",a.style.top="-1000px",document.body.appendChild(a),t.dataTransfer.setDragImage(a,t.offsetX,t.offsetY),this.classList.add("dragging"))}function s(t){return t.preventDefault&&t.preventDefault(),t.dataTransfer.dropEffect="move",!1}function i(t){this!==e&&this.classList.add("over")}function r(t){this.classList.remove("over")}function o(a){if(a.stopPropagation&&a.stopPropagation(),e!==this){var n=Array.from(t.querySelectorAll(".Aggregation-Item-wrap"));n.indexOf(e)<n.indexOf(this)?this.after(e):this.before(e);var s=Array.from(t.querySelectorAll(".Aggregation-Item-wrap")).map(function(t){return t.getAttribute("data-fldname")});console.log("Updated xOrder:",s);var i=e.getAttribute("data-fldname");console.log("Selected fldname:",i);var r=_analyticsCharts.metaData.find(function(t){return t.fldname===i});if(r){var o=r.ftransid;console.log("Found ftransid:",o);var c={page:"Analytics",transId:o,properties:{XAXISFIELDS:s.join(",")},allUsers:!1};_entityCommon.setAnalyticsDataWS(c,function(){},function(t){showAlertDialog("error",t.status+" "+t.statusText)})}else console.warn("Metadata item not found for selected fldname:",i)}return!1}function c(e){this.classList.remove("dragging"),Array.from(t.querySelectorAll(".Aggregation-Item-wrap:not(.selected)")).forEach(function(t){t.classList.remove("over")}),a&&(document.body.removeChild(a),a=null)}function l(t){t.addEventListener("dragstart",n,!1),t.addEventListener("dragenter",i,!1),t.addEventListener("dragover",s,!1),t.addEventListener("dragleave",r,!1),t.addEventListener("drop",o,!1),t.addEventListener("dragend",c,!1)}t.querySelectorAll(".Aggregation-Item-wrap").forEach(function(t,e){0!==e?(t.setAttribute("draggable","true"),l(t)):t.setAttribute("draggable","false")}),new MutationObserver(function(e){e.forEach(function(e){e.addedNodes.length&&e.addedNodes.forEach(function(e){e.classList&&e.classList.contains("Aggregation-Item-wrap")&&(0!==Array.from(t.children).indexOf(e)&&(e.setAttribute("draggable","true"),l(e)))})})}).observe(t,{childList:!0})});